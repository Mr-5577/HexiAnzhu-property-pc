(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-badbf98c"],{"0f90":function(t,e,s){"use strict";s.d(e,"a",(function(){return r}));var a=null;function o(){try{var t=navigator.userAgent;if(null!=t.match(/Windows\sPhone/i))return!0;if(null!=t.match(/iPhone|iPod/i))return!0;if(null!=t.match(/Android/i))return!0;if(null!=t.match(/Edge\D?\d+/i))return!0;var e=t.match(/Trident\D?\d+/i),s=t.match(/MSIE\D?\d+/i),a=t.match(/OPR\D?\d+/i),o=t.match(/Firefox\D?\d+/i),i=t.match(/x64/i);if(null==e&&null==s&&null!==i)return!0;if(null!==o){if(o=o[0].match(/\d+/),o[0]>=41||null!==i)return!0}else if(null!==a){if(a=a[0].match(/\d+/),a[0]>=32)return!0}else if(null==e&&null==s){var l=t.match(/Chrome\D?\d+/i);if(null!==l&&(l=l[0].match(/\d+/),l[0]>=41))return!0}return!1}catch(r){return!0}}if(o()){var i=document.head||document.getElementsByTagName("head")[0]||document.documentElement,l=document.createElement("script");l.src="http://localhost:8000/CLodopfuncs.js?priority=1",i.insertBefore(l,i.firstChild),l=document.createElement("script"),l.src="http://localhost:18000/CLodopfuncs.js?priority=0",i.insertBefore(l,i.firstChild)}function r(t,e){var s,i="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='http://www.lodop.net/download.html' target='_blank'>执行安装</a>,安装后请刷新页面或重新进入。</font>",l="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='http://www.lodop.net/download.html' target='_blank'>执行升级</a>,升级后请重新进入。</font>",r="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='http://www.lodop.net/download.html' target='_blank'>执行安装</a>,安装后请刷新页面或重新进入。</font>",n="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='http://www.lodop.net/download.html' target='_blank'>执行升级</a>,升级后请重新进入。</font>",d="<br><br><font color='#FF00FF'>（注意：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】->【附加组件】->【扩展】中先卸它）</font>",c="<br><br><font color='#FF00FF'>(如果此前正常，仅因浏览器升级或重安装而出问题，需重新执行以上安装）</font>",h="<br><font color='#FF00FF'>CLodop云打印服务(localhost本地)未安装启动!点击这里<a href='http://www.lodop.net/download.html' target='_blank'>执行安装</a>,安装后请刷新页面。</font>",p="<br><font color='#FF00FF'>CLodop云打印服务需升级!点击这里<a href='http://www.lodop.net/download.html' target='_blank'>执行升级</a>,升级后请刷新页面。</font>";try{var b=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0;if(o()){try{s=getCLodop()}catch(m){}if(!s&&"complete"!==document.readyState)return void alert("C-Lodop没准备好，请稍后再试！");if(!s)return void(b?document.write(h):document.body.innerHTML=h+document.body.innerHTML);CLODOP.CVERSION<"3.0.2.8"&&(b?document.write(p):document.body.innerHTML=p+document.body.innerHTML),e&&e.parentNode&&e.parentNode.removeChild(e),t&&t.parentNode&&t.parentNode.removeChild(t)}else{var u=b&&navigator.userAgent.indexOf("x64")>=0;if(void 0!=t||void 0!=e?s=b?t:e:null==a?(s=document.createElement("object"),s.setAttribute("width",0),s.setAttribute("height",0),s.setAttribute("style","position:absolute;left:0px;top:-100px;width:0px;height:0px;"),b?s.setAttribute("classid","clsid:2105C259-1E0C-4534-8141-A753534CB4CA"):s.setAttribute("type","application/x-print-lodop"),document.documentElement.appendChild(s),a=s):s=a,null==s||"undefined"==typeof s.VERSION)return navigator.userAgent.indexOf("Chrome")>=0&&(document.body.innerHTML=c+document.body.innerHTML),navigator.userAgent.indexOf("Firefox")>=0&&(document.body.innerHTML=d+document.body.innerHTML),u?document.write(r):b?document.write(i):document.body.innerHTML=i+document.body.innerHTML,s}return s.VERSION<"6.2.2.0"?(o()||(u?document.write(n):b?document.write(l):document.body.innerHTML=l+document.body.innerHTML),s):s}catch(m){alert("getLodop出错:"+m)}}},"2e7f":function(t,e,s){"use strict";s("fa33")},"5c1a":function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"发送人","prop":"realname","show":true,"width":120},{"label":"联系电话","prop":"phone","show":true,"width":120},{"label":"发送状态","prop":"status_text","show":true,"cstcolor":"statusColor","width":120},{"label":"发送时间","prop":"create_time","show":true,"color":"#999","width":170},{"label":"描述","prop":"content","color":"#999","show":true},{"label":"操作","prop":"","type":"button","show":true,"width":130,"btns":[{"name":"重新发送","type":"primary","size":"small","round":true,"hide":"fshide","action":"send","role":"send","token":"Btn-2ZtEucmLizAeXjt76DBsZK2M"}]}]}')},"91d1":function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"欠费说明","prop":"content","show":true},{"label":"创建人员","prop":"uname","show":true,"color":"#999"},{"label":"创建时间","prop":"create_time","show":true,"color":"#999"},{"label":"操作","prop":"","type":"button","show":true,"btns":[{"name":"编辑","type":"primary","size":"small","round":true,"action":"edit","role":"edit","token":"Btn-YsGL2fIcDYngjQlMYP8Cx47R"},{"name":"删除","type":"danger","size":"small","round":true,"action":"delete","role":"delete","token":"Btn-1BpNwm0QjP8KUIQmlryYPQmp"}]}]}')},b3fa:function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"资源名称","prop":"resources_name","show":true,"color":"#69da61"},{"label":"面积","prop":"area","show":true,"color":"#999"},{"label":"科目名称","prop":"subject_name","show":true,"color":"#999"},{"label":"上次推送","prop":"last_send_time","show":true,"width":150},{"label":"客户姓名","prop":"owner_name","show":true},{"label":"联系电话","prop":"owner_tel","show":true,"color":"#999"},{"label":"欠费周期","prop":"cycle","show":true,"color":"#999"},{"label":"欠费金额","prop":"money","show":true,"color":"#ffcb3c"}]}')},bd55:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{attrs:{id:"arrearages"}},[e("div",{staticClass:"top"},[e("div",{staticClass:"main"},[e("div",{staticClass:"common-left"},[e("span",{staticClass:"common-chose-info",on:{click:function(e){return t.$refs.showFilterVillage.showDialog()}}},[e("i",{staticClass:"iconfont icondaqu"}),t._v(" "+t._s(t.choseVillageInfo.name)+" ")]),e("el-select",{attrs:{placeholder:"请选择类型"},on:{change:t.tableLoad},model:{value:t.typeVal,callback:function(e){t.typeVal=e},expression:"typeVal"}},[e("el-option",{attrs:{label:"欠费明细",value:2}}),e("el-option",{attrs:{label:"欠费统计",value:1}})],1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchVal,expression:"searchVal"}],staticClass:"common-input",attrs:{type:"text",placeholder:"请输入姓名/房号/车牌号或车位"},domProps:{value:t.searchVal},on:{input:function(e){e.target.composing||(t.searchVal=e.target.value)}}}),e("el-button",{staticClass:"common-button",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.keySearch(!0)}}},[t._v(" 查询 ")])],1),e("div",{staticClass:"common-right"},[e("span",{on:{click:t.getExportData}},[e("workIcon",{staticClass:"common-right-icon",attrs:{name:"export",title:"导出"}})],1),t.$menu.getters.judgeRole("Btn-FDefkBASck2RmkklXTDhIfij")?e("span",{directives:[{name:"print",rawName:"v-print",value:{id:"#tablePrint",popTitle:"欠费列表"},expression:"{ id: '#tablePrint', popTitle: '欠费列表' }"}],on:{click:t.printHandle}},[e("workIcon",{staticClass:"common-right-icon",attrs:{name:"print",title:"打印"}})],1):t._e()])])]),e("div",{staticClass:"main-wp"},[e("div",{staticClass:"select-wp"},[e("el-select",{attrs:{clearable:"",placeholder:"请选择欠费科目"},on:{change:t.subjectChange},model:{value:t.subjectVal,callback:function(e){t.subjectVal=e},expression:"subjectVal"}},t._l(t.subOptions,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),"rooms"==t.isRoom?e("el-select",{attrs:{clearable:"",placeholder:"请选择楼栋"},on:{change:t.buildChange},model:{value:t.buildVal,callback:function(e){t.buildVal=e},expression:"buildVal"}},t._l(t.buildOptions,(function(t){return e("el-option",{key:t.id,attrs:{label:t.block,value:t.id}})})),1):t._e(),"rooms"==t.isRoom?e("el-select",{attrs:{clearable:"",placeholder:"请选择单元"},on:{change:t.tableLoad},model:{value:t.unitVal,callback:function(e){t.unitVal=e},expression:"unitVal"}},t._l(t.unitOptions,(function(t){return e("el-option",{key:t.id,attrs:{label:t.unit,value:t.id}})})),1):t._e(),e("el-date-picker",{attrs:{type:"daterange",align:"center","value-format":"timestamp","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.tableLoad},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}}),1==t.typeVal&&t.$menu.getters.judgeRole("Btn-loHASAOCLV23SGXRWs1J7bhf")?e("el-button",{attrs:{type:"primary",round:""},on:{click:t.RecordInit}},[t._v(" 短信发送记录 ")]):t._e()],1),e("div",{staticClass:"table-wp"},[e("cus-table",{ref:"seleTable",attrs:{datas:t.tableData,cusColums:t.columns,cusConf:t.conf,ispaging:!0,check:!0},on:{sizeChange:t.sizeChange,currentChange:t.currentChange,selectionChange:t.selectionChange,print:t.arrearagePrint,detail:t.desRecord,addMsg:t.addMsg,split:t.splitStart}}),e("div",{staticClass:"btn-wp"},[1==t.typeVal&&t.$menu.getters.judgeRole("Btn-ZFBVu9LLBTmnRUSEsVHZTEPG")?e("el-button",{attrs:{disabled:0===t.tableSelected.length,type:"primary",round:""},on:{click:t.sendNote}},[t._v(" 发送短信("+t._s(t.tableSelected.length)+")条 ")]):t._e(),2==t.typeVal&&t.$menu.getters.judgeRole("Btn-wtNgnHsqUdIRipro9UdnFeUg")?e("el-button",{attrs:{disabled:0===t.tableSelected.length,type:"primary",round:""},on:{click:t.addReason}},[t._v(" 欠费原因("+t._s(t.tableSelected.length)+")条 ")]):t._e(),t.$menu.getters.judgeRole("Btn-5w00kBx59ms59aTa53411xCY")?e("el-button",{attrs:{disabled:0===t.tableSelected.length,type:"primary empty",round:""},on:{click:t.batchPrint}},[t._v(" 批量打印已选("+t._s(t.tableSelected.length)+") ")]):t._e(),2==t.typeVal&&t.$menu.getters.judgeRole("Btn-QDfdR4Or5TVFVSY9IE9hM6J3")?e("el-button",{attrs:{disabled:0===t.tableSelected.length,type:"warning empty",round:""},on:{click:t.batchDel}},[t._v(" 批量删除("+t._s(t.tableSelected.length)+")条 ")]):t._e()],1),1==t.typeVal?e("span",{staticClass:"total"},[t._v(" 合计金额： "),e("span",[t._v(t._s(t.totalMoney)+"元")])]):t._e()],1)]),e("filter-village",{ref:"showFilterVillage",attrs:{vid:t.choseVillageInfo.vid},on:{choseInfo:t.filterVillage}}),e("el-dialog",{staticClass:"splitDialog",attrs:{visible:t.showSplitDialog,title:"欠费记录拆分",width:"35%","close-on-click-modal":!1},on:{"update:visible":function(e){t.showSplitDialog=e}}},[e("el-scrollbar",{staticStyle:{height:"100%"}},[e("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"hide-required-asterisk":!0}},[e("el-form-item",{staticClass:"remark",attrs:{label:"拆分时间",prop:"stime"}},[e("el-date-picker",{attrs:{type:"date",align:"center","value-format":"timestamp","picker-options":t.pickerOptions,placeholder:"请选择拆分时间"},on:{change:t.stimeChange},model:{value:t.ruleForm.stime,callback:function(e){t.$set(t.ruleForm,"stime",e)},expression:"ruleForm.stime"}})],1),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.ruleForm.stime,expression:"ruleForm.stime"}],attrs:{label:`拆分金额（${t.oneTime}）`,type:"number",prop:"oneMoney"}},[e("el-input",{attrs:{type:"number",placeholder:"请输入第一段拆分金额"},model:{value:t.ruleForm.oneMoney,callback:function(e){t.$set(t.ruleForm,"oneMoney",e)},expression:"ruleForm.oneMoney"}})],1),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.ruleForm.stime,expression:"ruleForm.stime"}],attrs:{label:`拆分金额（${t.twoTime}）`,prop:"twoMoney"}},[e("el-input",{attrs:{placeholder:"请输入第二段拆分金额"},model:{value:t.ruleForm.twoMoney,callback:function(e){t.$set(t.ruleForm,"twoMoney",e)},expression:"ruleForm.twoMoney"}})],1)],1)],1),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{loading:t.isCommit,type:"primary",round:""},on:{click:t.splitSubmit}},[t._v(" 提交保存 ")]),e("el-button",{attrs:{loading:t.isCommit,type:"info",round:""},on:{click:function(e){t.showSplitDialog=!1}}},[t._v(" 取消 ")])],1)],1),e("el-dialog",{staticClass:"descDialog",attrs:{visible:t.showDescDialog,title:t.isAdd?"新增欠费说明":"编辑欠费说明",width:"30%","close-on-click-modal":!1},on:{"update:visible":function(e){t.showDescDialog=e}}},[e("div",{staticClass:"title"},[t._v("欠费说明")]),e("el-input",{attrs:{type:"textarea",resize:"none",rows:5,placeholder:"请填写欠费说明"},model:{value:t.descVal,callback:function(e){t.descVal=e},expression:"descVal"}}),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{loading:t.isCommit,type:"primary",round:""},on:{click:t.descSubmit}},[t._v(" 提交保存 ")]),e("el-button",{attrs:{loading:t.isCommit,type:"info",round:""},on:{click:function(e){t.showDescDialog=!1}}},[t._v(" 取消 ")])],1)],1),e("el-dialog",{staticClass:"descRecordDialog",attrs:{visible:t.showDescRecordDialog,title:"欠费说明记录",width:"55%","close-on-click-modal":!1},on:{"update:visible":function(e){t.showDescRecordDialog=e}}},[e("div",{staticClass:"table-wp"},[e("cus-table",{attrs:{datas:t.descTableData,cusColums:t.descColumns,cusConf:t.descConf},on:{edit:t.descEdit,delete:t.descDel}})],1)]),e("el-dialog",{staticClass:"reasonDialog",attrs:{visible:t.showReasonDialog,title:"添加欠费原因",width:"30%","close-on-click-modal":!0},on:{"update:visible":function(e){t.showReasonDialog=e}}},[e("div",{staticClass:"title"},[t._v("选择欠费原因")]),0==t.reasonList.length?e("div",{staticClass:"tip"},[t._v("暂无欠费原因数据！")]):e("el-radio-group",{model:{value:t.radioVal,callback:function(e){t.radioVal=e},expression:"radioVal"}},t._l(t.reasonList,(function(s){return e("el-radio",{key:s.id,attrs:{label:s.id}},[t._v(" "+t._s(s.name)+" ")])})),1),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{loading:t.isCommit,type:"primary",round:""},on:{click:t.confirm}},[t._v(" 提交保存 ")]),e("el-button",{attrs:{loading:t.isCommit,type:"info",round:""},on:{click:function(e){t.showReasonDialog=!1}}},[t._v(" 取消 ")])],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showPrint,expression:"showPrint"}],attrs:{id:"tablePrint"}},[e("table",[t._m(0),e("tbody",t._l(t.tableData,(function(s,a){return e("tr",{key:a},[e("td",[t._v(t._s(s.resources_name))]),e("td",[t._v(t._s(s.subject_name))]),e("td",[t._v(t._s(s.owner_name))]),e("td",[t._v(t._s(s.owner_tel))]),e("td",[t._v(t._s(s.cycle))]),e("td",[t._v(t._s(s.money))]),e("td",[t._v(t._s(s.last_send_time))]),e("td",[t._v(t._s(s.arrearsreson))])])})),0)]),t.tableData.length?t._e():e("div",{staticClass:"table-empty"},[e("span",[t._v("暂无数据!")])])]),e("el-dialog",{staticClass:"recordDialog",attrs:{visible:t.showRecordDialog,title:"短信发送记录",width:"60%","close-on-click-modal":!1},on:{"update:visible":function(e){t.showRecordDialog=e}}},[e("div",{staticClass:"select-wp"},[e("el-select",{attrs:{clearable:"",placeholder:"请选择发送状态"},on:{change:t.recordTableLoad},model:{value:t.statusVal,callback:function(e){t.statusVal=e},expression:"statusVal"}},[e("el-option",{attrs:{label:"成功",value:1}}),e("el-option",{attrs:{label:"失败",value:2}})],1),e("el-date-picker",{attrs:{type:"daterange",align:"center","value-format":"timestamp","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.recordTableLoad},model:{value:t.sendDate,callback:function(e){t.sendDate=e},expression:"sendDate"}}),e("el-input",{attrs:{placeholder:"请输入关键字查询"},on:{change:t.recordTableLoad},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),e("span",{staticClass:"export",on:{click:t.exportRecordData}},[e("workIcon",{staticClass:"common-right-icon",attrs:{name:"export",title:"导出"}})],1)],1),e("div",{staticClass:"table-wp"},[e("cus-table",{attrs:{datas:t.recordTableData,cusColums:t.recordColumns,cusConf:t.recordConf,ispaging:!0,check:!0},on:{sizeChange:t.recordSizeChange,currentChange:t.recordCurrentChange,selectionChange:t.recordSelectionChange,send:t.sendAgain}}),t.$menu.getters.judgeRole("Btn-2ZtEucmLizAeXjt76DBsZK2M")?e("el-button",{staticClass:"batch",attrs:{disabled:0===t.recordSelects.length,type:"primary empty",round:""},on:{click:t.batchSendAgain}},[t._v(" 批量重新发送("+t._s(t.recordSelects.length)+")条 ")]):t._e()],1)])],1)},o=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("thead",{staticStyle:{display:"table-header-group","font-weight":"bold"}},[e("tr",[e("th",[t._v("资源名称")]),e("th",[t._v("科目名称")]),e("th",[t._v("客户姓名")]),e("th",[t._v("联系电话")]),e("th",[t._v("欠费周期")]),e("th",[t._v("欠费金额")]),e("th",[t._v("上次推送")]),e("th",[t._v("欠费原因")])])])}],i=(s("5948"),s("fa88")),l=s("b3fa"),r=s("5c1a"),n=s("91d1"),d=s("4698"),c=s("0f90"),h={name:"arrearage",components:{workIcon:d["a"]},data(){return{urlObj:{buildOfVillage:this.$api.state.Public.buildOfVillage.url,unitOfBuild:this.$api.state.Public.unitOfBuild.url,villageend:this.$api.state.Charge.villageend.url,scountlist:this.$api.state.Charge.scountlist.url,getarrearsreson:this.$api.state.Charge.getarrearsreson.url,setarrearsreson:this.$api.state.Charge.setarrearsreson.url,sendmsgarrears:this.$api.state.Charge.sendmsgarrears.url,checksubjecttype:this.$api.state.Charge.checksubjecttype.url,getsendmsglist:this.$api.state.Charge.getsendmsglist.url,sendmsgagain:this.$api.state.Charge.sendmsgagain.url,costaddreason:this.$api.state.Charge.costaddreason.url,costeditreason:this.$api.state.Charge.costeditreason.url,costdelreason:this.$api.state.Charge.costdelreason.url,costreasonlist:this.$api.state.Charge.costreasonlist.url,getcostcycle:this.$api.state.Charge.getcostcycle.url,costsplitmoney:this.$api.state.Charge.costsplitmoney.url,splitcost:this.$api.state.Charge.splitcost.url,delcost:this.$api.state.Charge.delcost.url},searchVal:"",choseVillageInfo:{name:"全部项目",vid:0},typeVal:2,tableData:[],conf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},subjectVal:"",subOptions:[],isRoom:!1,buildVal:"",buildOptions:[],unitVal:"",unitOptions:[],dateValue:[],tableSelected:[],showReasonDialog:!1,radioVal:"",isCommit:!1,reasonList:[],showPrint:!1,totalMoney:0,showRecordDialog:!1,statusVal:"",sendDate:[],keywords:"",recordTableData:[],recordColumns:r.list,recordConf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},recordSelects:[],showDescDialog:!1,isAdd:!0,descVal:"",cindex:"",showDescRecordDialog:!1,descTableData:[],descColumns:n.list,descConf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},showSplitDialog:!1,sindex:"",pickerOptions:{},oneTime:"",twoTime:"",ruleForm:{stime:"",oneMoney:"",twoMoney:""},rules:{stime:[{required:!0,message:"请选择拆分时间",trigger:"change"}],oneMoney:[{required:!0,message:"请输入第一段拆分金额",trigger:"blur"}],twoMoney:[{required:!0,message:"请输入第二段拆分金额",trigger:"blur"}]}}},computed:{columns(){return 2==this.typeVal?i.list:l.list}},mounted(){let t=sessionStorage.getItem("vid"),e=sessionStorage.getItem("vname");t&&(this.choseVillageInfo.vid=t,this.choseVillageInfo.name=e),this.tableLoad(),this.getSubjectList(),this.getBuildList()},methods:{dateFormat(t){let e=new Date(1e3*t),s=e.getFullYear(),a=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,o=e.getDate()<10?"0"+e.getDate():e.getDate();return s+""+a+o},getSubjectList(){let t={vid:this.choseVillageInfo.vid};this.$axios.post(this.urlObj.villageend,t).then(t=>{if(200===t.Code)this.subOptions=t.Data?t.Data:[];else{let e=t.Message?t.Message:"获取科目数据失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})},getBuildList(){let t={vid:this.choseVillageInfo.vid};this.$axios.post(this.urlObj.buildOfVillage,t).then(t=>{if(200===t.Code)this.buildOptions=t.Data?t.Data:[];else{let e=t.Message?t.Message:"获取楼栋数据失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})},getUnitList(){let t={bid:this.buildVal};this.$axios.post(this.urlObj.unitOfBuild,t).then(t=>{if(200===t.Code)this.unitOptions=t.Data?t.Data:[];else{let e=t.Message?t.Message:"获取单元数据失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})},tableLoad(){this.conf.loadStatus=!0;let t={page:this.conf.curPage,limit:this.conf.limit,vid:this.choseVillageInfo.vid,subject_id:this.subjectVal,stime:this.dateValue&&this.dateValue[0]?this.dateValue[0]/1e3:"",etime:this.dateValue&&this.dateValue[1]?this.dateValue[1]/1e3:"",keywords:this.searchVal.trim(),type:this.typeVal,is_excel:0};"rooms"==this.isRoom&&(t.bid=this.buildVal,t.unit=this.unitVal),this.$axios.post(this.urlObj.scountlist,t).then(t=>{if(200===t.Code){if(this.conf.dataTotal=t.Data.total,this.tableData=t.Data.data,t.Data.data&&t.Data.data.length>0){let e=0;t.Data.data.forEach(t=>{e=_.add(Number(e),Number(t.money))}),this.totalMoney=e.toFixed(2)}this.conf.loadStatus=!1,this.conf.emptyText=""}else 204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.tableData=[],this.conf.emptyText=t.Message,this.conf.dataTotal=0,this.conf.loadStatus=!1)}).catch(()=>{this.tableData=[],this.conf.emptyText="服务器连接失败...",this.conf.dataTotal=0,this.conf.loadStatus=!1})},keySearch(){this.conf={loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},this.tableLoad()},filterVillage(t){this.choseVillageInfo.name=t.name,this.choseVillageInfo.vid=t.vid,this.isRoom="",this.searchVal="",this.subjectVal="",this.subOptions=[],this.buildVal="",this.buildOptions=[],this.unitVal="",this.unitOptions=[],this.dateValue=[],this.keySearch(),this.getSubjectList(),this.getBuildList()},sizeChange(t){this.conf.limit=t,this.tableLoad()},currentChange(t){this.conf.curPage=t,this.tableLoad()},subjectChange(t){t?this.$axios.post(this.urlObj.checksubjecttype,{id:t}).then(t=>{if(200===t.Code)this.isRoom=t.Data,this.tableLoad();else{let e=t.Message?t.Message:"验证资源类型失败！";this.$message({message:e,type:"error"})}}).catch(()=>{}):(this.isRoom=!1,this.tableLoad())},buildChange(t){this.unitVal="",this.unitOptions=[],t&&this.getUnitList(),this.tableLoad()},selectionChange(t){this.tableSelected=t},sendNote(){let t=this.tableSelected.map(t=>t.cost_ids),e={vid:this.choseVillageInfo.vid,cost_group:t};this.$confirm(`确定要给这${this.tableSelected.length}条欠费用户发送催收短信吗?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.post(this.urlObj.sendmsgarrears,e).then(t=>{if(200===t.Code){this.$message({message:"短信发送成功！",type:"success"});let t=this.$refs.seleTable.$children[0];t.clearSelection()}else{let e=t.Message?t.Message:"短信发送失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})}).catch(()=>{})},addReason(){this.radioVal="",this.reasonList=[],this.showReasonDialog=!0,this.getReasonList()},getReasonList(){this.$axios.post(this.urlObj.getarrearsreson).then(t=>{if(200===t.Code)this.reasonList=t.Data?t.Data:[];else{let e=t.Message?t.Message:"欠费原因数据获取失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})},confirm(){if(this.radioVal){this.isCommit=!0;let t={ids:this.tableSelected.map(t=>t.id),arrears_reson_id:this.radioVal};this.$axios.post(this.urlObj.setarrearsreson,t).then(t=>{if(200===t.Code)this.$message({message:"欠费原因设置成功！",type:"success"}),this.showReasonDialog=!1,this.tableLoad();else{let e=t.Message?t.Message:"欠费原因数据获取失败！";this.$message({message:e,type:"error"})}this.isCommit=!1}).catch(()=>{this.isCommit=!1})}else this.$message({message:"请选择欠费原因！",type:"warning"})},getExportData(){let t={page:this.conf.curPage,limit:this.conf.limit,vid:this.choseVillageInfo.vid,subject_id:this.subjectVal,stime:this.dateValue&&this.dateValue[0]?this.dateValue[0]/1e3:"",etime:this.dateValue&&this.dateValue[1]?this.dateValue[1]/1e3:"",keywords:this.searchVal.trim(),type:this.typeVal,is_excel:1};"rooms"==this.isRoom&&(t.bid=this.buildVal,t.unit=this.unitVal),this.$axios.post(this.urlObj.scountlist,t).then(t=>{if(200===t.Code)this.exportExcel(t.Data);else{let e=t.Message?t.Message:"获取欠费数据失败！";this.$message({type:"error",message:e})}}).catch(()=>{})},exportExcel(t){let e="",a=[],o=[];1==this.typeVal?(e="欠费统计表",a=["资源名称","面积","科目名称","客户姓名","联系电话","欠费周期","欠费金额"],o=t.map(t=>{let e=[t.resources_name,Number(t.area)?Number(t.area):0,t.subject_name,t.owner_name,t.owner_tel,t.cycle,Number(t.money)?Number(t.money):0];return e})):(e="欠费明细表",a=["资源名称","科目名称","客户姓名","联系电话","欠费周期","欠费金额","上次推送","欠费原因"],o=t.map(t=>{let e=[t.resources_name,t.subject_name,t.owner_name,t.owner_tel,t.cycle,t.money,t.last_send_time,t.arrearsreson];return e}));try{Promise.all([s.e("chunk-3a869cfb"),s.e("chunk-2a5081b0"),s.e("chunk-3a96421c")]).then((()=>{let{export_json_to_excel:t}=s("628d");t(a,o,e)}).bind(null,s)).catch(s.oe),this.$notify({type:"success",title:"温馨提示",message:"导出报表成功",duration:1500})}catch(i){this.$notify({type:"error",title:"温馨提示",message:"导出报表失败",duration:1500})}},arrearagePrint(t){let e=this.tableData[t],s=new Date,a=s.getFullYear(),o=s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1,i=s.getDate()+1<10?"0"+s.getDate():s.getDate();var l=Object(c["a"])(),r="<style>table{width: 700px;border: 1px solid #aaa; border-collapse:collapse;};th{text-align: center;border: 2px solid #aaa;border-bottom:none;font-size: 29px;line-height:40px;height: 40px;}tbody td{text-align: center;height: 25px;border: 1px solid #aaa;font-size: 14px;}.bordertop{border-top: none}tr:last-child td{border-right: none;border-left: none;}tr:last-child td:first-child{border-left: 1px solid #aaa;}tr:last-child td:last-child{border-right: 1px solid #aaa;}</style>",n=r+"<body> <form><table cellspacing='0' ><tbody><tr><th colspan='4'>缴费通知单</th></tr><tr><td colspan='4' class='bordertop'>小区:"+this.choseVillageInfo.name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;房号："+e.resources_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;业主姓名："+e.owner_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;制单日期："+a+"-"+o+"-"+i+"</td></tr><tr><td>科目名称</td><td>描述</td><td>单价</td><td>金额(人民币)</td></tr><tr><td>"+e.subject_name+"</td><td>"+e.cycle+"</td><td>"+e.price+"</td><td>"+e.money+"</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>总&nbsp;&nbsp;&nbsp;&nbsp;计(人民币)</td><td colspan='2'>"+e.money+"</td><td></td></tr><tr><td colspan='4'>为维护小区全体业主共同利益及保证小区物业管理工作正常进行，请您配合及时交纳相关费用，谢谢！</td></tr><tr style='height: 80px;'><td>关注公众号</br>绑定房产缴费</td><td><img src='/static/qrcode/qrcode.jpg' width='80px' height='80px' ></td><td colspan='2'>"+this.choseVillageInfo.name+"</br>物业服务中心</br></br></td></tr></tbody></table></form></body>";l.PRINT_INIT("打印控件功能演示"),l.ADD_PRINT_TEXT(),l.ADD_PRINT_HTM(30,30,500,1e3,n),l.PREVIEW()},batchPrint(){let t=new Date,e=t.getFullYear(),s=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,a=t.getDate()+1<10?"0"+t.getDate():t.getDate();for(var o="",i=this.tableSelected.length%3,l=Math.floor(this.tableSelected.length/3),r=0;r<l;r++){let t='<div id="pagepage'+r+"\"><style >table {\twidth: 700px;border: 1px solid #aaa;; border-collapse:collapse;margin-bottom: 40px;}table:last-child { margin-bottom: 0; }th {text-align: center;border: 1px solid #aaa;border-bottom:none;font-size: 20px;height: 40px;}tbody td{text-align: center;height: 25px;border: 1px solid #aaa;font-size: 14px;}.bordertop{border-top: none}tr:last-child td{border-right: none;border-left: none;}tr:last-child td:first-child{border-left: 1px solid #aaa;}tr:last-child td:last-child{border-right: 1px solid #aaa;} </style><table cellspacing='0' ><tbody><tr><th colspan='4'>缴费通知单</th></tr><tr><td colspan='4' class='bordertop'>小区:"+this.choseVillageInfo.name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;房号："+this.tableSelected[3*r].resources_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;业主姓名："+this.tableSelected[3*r].owner_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;制单日期："+e+"-"+s+"-"+a+"</td></tr><tr><td>科目名称</td><td>描述</td><td>单价</td><td>金额(人民币)</td></tr><tr><td>"+this.tableSelected[3*r].subject_name+"</td><td>"+this.tableSelected[3*r].cycle+"</td><td>"+this.tableSelected[3*r].price+"</td><td>"+this.tableSelected[3*r].money+"</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>总&nbsp;&nbsp;&nbsp;&nbsp;计(人民币)</td><td colspan='2'>"+this.tableSelected[3*r].money+"</td><td></td></tr><tr><td colspan='4'>为维护小区全体业主共同利益及保证小区物业管理工作正常进行，请您配合及时交纳相关费用，谢谢！</td></tr><tr style='height: 80px;'><td>关注公众号</br>绑定房产缴费</td><td><img src='http://est.yangguangzhiye.com/Uploads/qrcode/meishan.jpg' width='80px' height='80px' ></td><td colspan='2'>"+this.choseVillageInfo.name+"</br>物业服务中心</br></br></td></tr></tbody></table><table cellspacing='0' ><tbody><tr><th colspan='4'>缴费通知单</th></tr><tr><td colspan='4' class='bordertop'>小区:"+this.choseVillageInfo.name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;房号："+this.tableSelected[3*r+1].resources_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;业主姓名："+this.tableSelected[3*r+1].owner_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;制单日期："+e+"-"+s+"-"+a+"</td></tr><tr><td>科目名称</td><td>描述</td><td>单价</td><td>金额(人民币)</td></tr><tr><td>"+this.tableSelected[3*r+1].subject_name+"</td><td>"+this.tableSelected[3*r+1].cycle+"</td><td>"+this.tableSelected[3*r+1].price+"</td><td>"+this.tableSelected[3*r+1].money+"</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>总&nbsp;&nbsp;&nbsp;&nbsp;计(人民币)</td><td colspan='2'>"+this.tableSelected[3*r+1].money+"</td><td></td></tr><tr><td colspan='4'>为维护小区全体业主共同利益及保证小区物业管理工作正常进行，请您配合及时交纳相关费用，谢谢！</td></tr><tr style='height: 80px;'><td>关注公众号</br>绑定房产缴费</td><td><img src='http://est.yangguangzhiye.com/Uploads/qrcode/meishan.jpg' width='80px' height='80px' ></td><td colspan='2'>"+this.choseVillageInfo.name+"</br>物业服务中心</br></br></td></tr></tbody></table><table cellspacing='0' ><tbody><tr><th colspan='4'>缴费通知单</th></tr><tr><td colspan='4' class='bordertop'>小区:"+this.choseVillageInfo.name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;房号："+this.tableSelected[3*r+2].resources_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;业主姓名："+this.tableSelected[3*r+2].owner_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;制单日期："+e+"-"+s+"-"+a+"</td></tr><tr><td>科目名称</td><td>描述</td><td>单价</td><td>金额(人民币)</td></tr><tr><td>"+this.tableSelected[3*r+2].subject_name+"</td><td>"+this.tableSelected[3*r+2].cycle+"</td><td>"+this.tableSelected[3*r+2].price+"</td><td>"+this.tableSelected[3*r+2].money+"</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>总&nbsp;&nbsp;&nbsp;&nbsp;计(人民币)</td><td colspan='2'>"+this.tableSelected[3*r+2].money+"</td><td></td></tr><tr><td colspan='4'>为维护小区全体业主共同利益及保证小区物业管理工作正常进行，请您配合及时交纳相关费用，谢谢！</td></tr><tr style='height: 80px;'><td>关注公众号</br>绑定房产缴费</td><td><img src='http://est.yangguangzhiye.com/Uploads/qrcode/meishan.jpg' width='80px' height='80px' ></td><td colspan='2'>"+this.choseVillageInfo.name+'</br>物业服务中心</br></br></td></tr></tbody></table></div><p style="page-break-after:always">\x3c!--分页元素--\x3e</p>';o+=t}1===i?o=o+'<div id="pagepage'+this.tableSelected.length+"\"><style >table {\twidth: 700px;border: 1px solid #aaa;; border-collapse:collapse;margin-bottom: 50px;}th {text-align: center;border: 1px solid #aaa;border-bottom:none;font-size: 20px;height: 40px;}tbody td{text-align: center;height: 25px;border: 1px solid #aaa;font-size: 14px;}.bordertop{border-top: none}tr:last-child td{border-right: none;border-left: none;}tr:last-child td:first-child{border-left: 1px solid #aaa;}tr:last-child td:last-child{border-right: 1px solid #aaa;} </style><table cellspacing='0' ><tbody><tr><th colspan='4'>缴费通知单</th></tr><tr><td colspan='4' class='bordertop'>小区:"+this.choseVillageInfo.name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;房号："+this.tableSelected[this.tableSelected.length-1].resources_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;业主姓名："+this.tableSelected[this.tableSelected.length-1].owner_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;制单日期："+e+"-"+s+"-"+a+"</td></tr><tr><td>科目名称</td><td>描述</td><td>单价</td><td>金额(人民币)</td></tr><tr><td>"+this.tableSelected[this.tableSelected.length-1].subject_name+"</td><td>"+this.tableSelected[this.tableSelected.length-1].cycle+"</td><td>"+this.tableSelected[this.tableSelected.length-1].price+"</td><td>"+this.tableSelected[this.tableSelected.length-1].money+"</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>总&nbsp;&nbsp;&nbsp;&nbsp;计(人民币)</td><td colspan='2'>"+this.tableSelected[this.tableSelected.length-1].money+"</td><td></td></tr><tr><td colspan='4'>为维护小区全体业主共同利益及保证小区物业管理工作正常进行，请您配合及时交纳相关费用，谢谢！</td></tr><tr style='height: 80px;'><td>关注公众号</br>绑定房产缴费</td><td><img src='http://est.yangguangzhiye.com/Uploads/qrcode/meishan.jpg' width='80px' height='80px' ></td><td colspan='2'>"+this.choseVillageInfo.name+'</br>物业服务中心</br></br></td></tr></tbody></table></div><p style="page-break-after:always">\x3c!--分页元素--\x3e</p>':2===i&&(o=o+'<div id="pagepage'+this.tableSelected.length+"\"><style >table {\twidth: 700px;border: 1px solid #aaa;; border-collapse:collapse;margin-bottom: 50px;}th {text-align: center;border: 1px solid #aaa;border-bottom:none;font-size: 20px;height: 40px;}tbody td{text-align: center;height: 25px;border: 1px solid #aaa;font-size: 14px;}.bordertop{border-top: none}tr:last-child td{border-right: none;border-left: none;}tr:last-child td:first-child{border-left: 1px solid #aaa;}tr:last-child td:last-child{border-right: 1px solid #aaa;} </style><table cellspacing='0' ><tbody><tr><th colspan='4'>缴费通知单</th></tr><tr><td colspan='4' class='bordertop'>小区:"+this.choseVillageInfo.name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;房号："+this.tableSelected[this.tableSelected.length-2].resources_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;业主姓名："+this.tableSelected[this.tableSelected.length-2].owner_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;制单日期："+e+"-"+s+"-"+a+"</td></tr><tr><td>科目名称</td><td>描述</td><td>单价</td><td>金额(人民币)</td></tr><tr><td>"+this.tableSelected[this.tableSelected.length-2].subject_name+"</td><td>"+this.tableSelected[this.tableSelected.length-2].cycle+"</td><td>"+this.tableSelected[this.tableSelected.length-2].price+"</td><td>"+this.tableSelected[this.tableSelected.length-2].money+"</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>总&nbsp;&nbsp;&nbsp;&nbsp;计(人民币)</td><td colspan='2'>"+this.tableSelected[this.tableSelected.length-2].money+"</td><td></td></tr><tr><td colspan='4'>为维护小区全体业主共同利益及保证小区物业管理工作正常进行，请您配合及时交纳相关费用，谢谢！</td></tr><tr style='height: 80px;'><td>关注公众号</br>绑定房产缴费</td><td><img src='http://est.yangguangzhiye.com/Uploads/qrcode/meishan.jpg' width='80px' height='80px' ></td><td colspan='2'>"+this.choseVillageInfo.name+"</br>物业服务中心</br></br></td></tr></tbody></table><table cellspacing='0' ><tbody><tr><th colspan='4'>缴费通知单</th></tr><tr><td colspan='4' class='bordertop'>小区:"+this.choseVillageInfo.name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;房号："+this.tableSelected[this.tableSelected.length-1].resources_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;业主姓名："+this.tableSelected[this.tableSelected.length-1].owner_name+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;制单日期："+e+"-"+s+"-"+a+"</td></tr><tr><td>科目名称</td><td>描述</td><td>单价</td><td>金额(人民币)</td></tr><tr><td>"+this.tableSelected[this.tableSelected.length-1].subject_name+"</td><td>"+this.tableSelected[this.tableSelected.length-1].cycle+"</td><td>"+this.tableSelected[this.tableSelected.length-1].price+"</td><td>"+this.tableSelected[this.tableSelected.length-1].money+"</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>总&nbsp;&nbsp;&nbsp;&nbsp;计(人民币)</td><td colspan='2'>"+this.tableSelected[this.tableSelected.length-1].money+"</td><td></td></tr><tr><td colspan='4'>为维护小区全体业主共同利益及保证小区物业管理工作正常进行，请您配合及时交纳相关费用，谢谢！</td></tr><tr style='height: 80px;'><td>关注公众号</br>绑定房产缴费</td><td><img src='http://est.yangguangzhiye.com/Uploads/qrcode/meishan.jpg' width='80px' height='80px' ></td><td colspan='2'>"+this.choseVillageInfo.name+'</br>物业服务中心</br></br></td></tr></tbody></table></div><p style="page-break-after:always">\x3c!--分页元素--\x3e</p>');var n=Object(c["a"])();n.PRINT_INIT("打印控件功能演示"),n.ADD_PRINT_TEXT(),n.ADD_PRINT_HTM(30,30,500,1e3,o),n.PREVIEW()},batchDel(){this.$prompt("请输入删除欠费原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"textarea",inputPattern:/^[\s\S]*.*[^\s][\s\S]*$/,inputErrorMessage:"删除欠费原因不能为空！"}).then(({value:t})=>{let e={ids:this.tableSelected.map(t=>t.id),reason:t};this.$axios.post(this.urlObj.delcost,e).then(t=>{if(200===t.Code)this.$message({type:"success",message:"删除欠费成功！"}),this.tableLoad();else{let e=t.Message?t.Message:"删除欠费失败！";this.$message({type:"error",message:e})}}).catch(()=>{})}).catch(()=>{})},printHandle(){this.showPrint=!0,setTimeout(()=>{this.showPrint=!1},500)},desRecord(t){this.cindex=t,this.showDescRecordDialog=!0,this.getRecordData()},getRecordData(){this.descConf.loadStatus=!0;let t={cost_id:this.tableData[this.cindex].id};this.$axios.post(this.urlObj.costreasonlist,t).then(t=>{200===t.Code?(t.Data&&t.Data.length>0&&t.Data.forEach(t=>{t.uname=t.creater?t.creater.realname:""}),this.descConf.dataTotal=0,this.descTableData=t.Data,this.descConf.loadStatus=!1,this.descConf.emptyText=""):204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.descTableData=[],this.descConf.emptyText=t.Message,this.descConf.dataTotal=0,this.descConf.loadStatus=!1)}).catch(()=>{this.descTableData=[],this.descConf.emptyText="服务器连接失败...",this.descConf.dataTotal=0,this.descConf.loadStatus=!1})},addMsg(t){this.isAdd=!0,this.cindex=t,this.descVal="",this.showDescDialog=!0},descSubmit(){if(this.descVal){this.isCommit=!0;let t="",e={content:this.descVal};this.isAdd?(t=this.urlObj.costaddreason,e.cost_id=this.tableData[this.cindex].id):(t=this.urlObj.costeditreason,e.id=this.descTableData[this.descIndex].id),this.$axios.post(t,e).then(t=>{if(200===t.Code){this.showDescDialog=!1;let t="";this.isAdd?(t="新增欠费说明成功！",this.tableLoad()):(t="编辑欠费说明成功！",this.getRecordData()),this.$message({type:"success",message:t})}else{let e=t.Message?t.Message:this.isAdd?"新增欠费说明失败！":"编辑欠费说明失败！";this.$message({type:"error",message:e})}this.isCommit=!1})}else this.$message({type:"warning",message:"请填写欠费说明！"})},descEdit(t){this.descIndex=t,this.isAdd=!1,this.descVal=this.descTableData[t].content,this.showDescDialog=!0},descDel(t){this.$confirm("此操作将删除当前欠费说明记录，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e={id:this.descTableData[t].id};this.$axios.post(this.urlObj.costdelreason,e).then(t=>{if(200===t.Code)this.$message({message:"欠费说明记录删除成功！",type:"success"}),this.showDescDialog=!1,this.getRecordData();else{let e=t.Message?t.Message:"欠费说明记录删除失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})}).catch(()=>{})},RecordInit(){this.statusVal="",this.sendDate=[],this.keywords="",this.showRecordDialog=!0,this.recordTableLoad()},recordTableLoad(){this.recordConf.loadStatus=!0;let t={page:this.recordConf.curPage,limit:this.recordConf.limit,vid:this.choseVillageInfo.vid,status:this.statusVal,start_time:this.sendDate&&this.sendDate[0]?this.sendDate[0]/1e3:"",end_time:this.sendDate&&this.sendDate[1]?this.sendDate[1]/1e3:"",keywords:this.keywords.trim()};this.$axios.post(this.urlObj.getsendmsglist,t).then(t=>{200===t.Code?(t.Data.data&&t.Data.data.length>0&&t.Data.data.forEach(t=>{t.status_text=1==t.status?"成功":"失败",t.statusColor=1==t.status?"#3ebb75":"rgb(245, 108, 108)",t.fshide=1==t.status}),this.recordConf.dataTotal=t.Data.total,this.recordTableData=t.Data.data,this.recordConf.loadStatus=!1,this.recordConf.emptyText=""):204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.recordTableData=[],this.recordConf.emptyText=t.Message,this.recordConf.dataTotal=0,this.recordConf.loadStatus=!1)}).catch(()=>{this.recordTableData=[],this.recordConf.emptyText="服务器连接失败...",this.recordConf.dataTotal=0,this.recordConf.loadStatus=!1})},recordSizeChange(t){this.recordConf.limit=t,this.recordTableLoad()},recordCurrentChange(t){this.recordConf.curPage=t,this.recordTableLoad()},recordSelectionChange(t){this.recordSelects=t},sendAgain(t){this.$confirm("确定要重新发送催收短信吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.sendRequest({ids:[this.recordTableData[t].id]})}).catch(()=>{})},batchSendAgain(){let t=this.recordSelects.every(t=>1!=t.status);t?this.$confirm(`确定要重新给当前${this.recordSelects.length}条欠费用户发送催收短信吗?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t={ids:this.recordSelects.map(t=>t.id)};this.sendRequest(t)}).catch(()=>{}):this.$message({type:"warning",message:"存在发送成功的数据，请重新选择！"})},sendRequest(t){this.$axios.post(this.urlObj.sendmsgagain,t).then(t=>{if(200===t.Code)this.$message({message:"短信发送成功！",type:"success"}),this.recordTableLoad();else{let e=t.Message?t.Message:"短信发送失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})},exportRecordData(){let t={page:this.recordConf.curPage,limit:this.recordConf.limit,vid:this.choseVillageInfo.vid,status:this.statusVal,start_time:this.sendDate&&this.sendDate[0]?this.sendDate[0]/1e3:"",end_time:this.sendDate&&this.sendDate[1]?this.sendDate[1]/1e3:"",keywords:this.keywords.trim(),is_excel:1};this.$axios.post(this.urlObj.getsendmsglist,t).then(t=>{if(200===t.Code)this.exportRecordExcel(t.Data);else{let e=t.Message?t.Message:"短信发送记录导出失败！";this.$message({type:"error",message:e})}}).catch(()=>{})},exportRecordExcel(t){let e="",a=[],o=[];e="短信发送记录",a=["发送人","联系电话","发送状态","发送时间","描述"],o=t.map(t=>{let e=[t.realname,t.phone,1==t.status?"成功":"失败",t.create_time,t.content];return e});try{Promise.all([s.e("chunk-3a869cfb"),s.e("chunk-2a5081b0"),s.e("chunk-3a96421c")]).then((()=>{let{export_json_to_excel:t}=s("628d");t(a,o,e)}).bind(null,s)).catch(s.oe),this.$notify({type:"success",title:"温馨提示",message:"导出报表成功",duration:1500})}catch(i){this.$notify({type:"error",title:"温馨提示",message:"导出报表失败",duration:1500})}},splitStart(t){this.sindex=t,this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.ruleForm={stime:"",oneMoney:"",twoMoney:""},this.showSplitDialog=!0,this.getCycleData()},getCycleData(){this.$axios.post(this.urlObj.getcostcycle,{id:this.tableData[this.sindex].id}).then(t=>{if(200===t.Code)t.Data.previewCostRepair&&t.Data.previewCostRepair.stime?(this.ruleForm.stime=1e3*t.Data.default_time,this.stimeChange(this.ruleForm.stime)):this.ruleForm.stime="",this.pickerOptions={disabledDate:e=>{if(e)return e.getTime()>1e3*t.Data.previewCostRepair.etime||e.getTime()<1e3*t.Data.previewCostRepair.stime}};else{let e=t.Message?t.Message:"欠费周期数据获取失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})},stimeChange(t){if(this.ruleForm.oneMoney="",this.ruleForm.twoMoney="",t){let t={id:this.tableData[this.sindex].id,time:this.ruleForm.stime/1e3};this.$axios.post(this.urlObj.costsplitmoney,t).then(t=>{if(200===t.Code)this.oneTime=this.dateFormat(t.Data.time_slot_one.stime)+"~"+this.dateFormat(t.Data.time_slot_one.etime),this.twoTime=this.dateFormat(t.Data.time_slot_two.stime)+"~"+this.dateFormat(t.Data.time_slot_two.etime),this.ruleForm.oneMoney=t.Data.time_slot_one.money,this.ruleForm.twoMoney=t.Data.time_slot_two.money;else{let e=t.Message?t.Message:"欠费时间段金额数据获取失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})}},splitSubmit(){this.$refs.ruleForm.validate(t=>{if(t){this.isCommit=!0;let t={id:this.tableData[this.sindex].id,time:this.ruleForm.stime/1e3,time_slot_one_money:this.ruleForm.oneMoney,time_slot_two_money:this.ruleForm.twoMoney};this.$axios.post(this.urlObj.splitcost,t).then(t=>{if(200===t.Code)this.$message({type:"success",message:"欠费拆分成功！"}),this.showSplitDialog=!1,this.tableLoad();else{let e=t.Message?t.Message:"欠费拆分失败！";this.$message({message:e,type:"error"})}this.isCommit=!1}).catch(()=>{this.isCommit=!1})}})}}},p=h,b=(s("2e7f"),s("1805")),u=Object(b["a"])(p,a,o,!1,null,null,null);e["default"]=u.exports},fa33:function(t,e,s){},fa88:function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"资源名称","prop":"resources_name","show":true,"color":"#69da61"},{"label":"科目名称","prop":"subject_name","show":true,"color":"#999"},{"label":"客户姓名","prop":"owner_name","show":true},{"label":"联系电话","prop":"owner_tel","show":true,"color":"#999","width":115},{"label":"欠费周期","prop":"cycle","show":true,"color":"#999"},{"label":"欠费金额","prop":"money","show":true,"color":"#ffcb3c"},{"label":"欠费原因","prop":"arrearsreson","show":true,"color":"#999"},{"label":"欠费说明","prop":"reason","show":true,"color":"#999","width":180},{"label":"说明记录","width":"100","type":"icon","icon":"detail","show":true,"action":"detail","token":"empty"},{"label":"操作","prop":"","type":"button","show":true,"width":280,"btns":[{"name":"打印单据","type":"warning","size":"small","round":true,"class":"sys-btn","action":"print","role":"print","token":"Btn-5w00kBx59ms59aTa53411xCY"},{"name":"新增说明","type":"primary","size":"small","round":true,"class":"sys-btn","action":"addMsg","role":"addMsg","token":"Btn-Vt5ye5cOy2uvCi8rUjwU66to"},{"name":"拆分","type":"success","size":"small","round":true,"action":"split","role":"split","token":"Btn-T2cCiCWBPhbYuY44p2VjKL7m"}]}]}')}}]);