(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4fc2f6f4"],{6216:function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"项目名称","prop":"vname","show":true,"color":"#999"},{"label":"车场名称","prop":"cname","show":true,"color":"#999"},{"label":"交费入口","prop":"gname","show":true},{"label":"交费金额","prop":"money","show":true,"color":"#69da61"},{"label":"订单号","prop":"order_no","show":true},{"label":"微信订单号","prop":"wechat_order_no","show":true,"color":"#999"},{"label":"客户openid","prop":"openid","width":180,"show":true,"color":"#999"},{"label":"交费时间","prop":"pay_time","show":true,"color":"#999"},{"label":"订单状态","prop":"status_text","show":true,"cstcolor":"statusColor"},{"type":"img","width":140,"label":"入场抓拍照片","prop":"photograph","show":true}]}')},"71d5":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{attrs:{id:"stop-charge"}},[e("div",{staticClass:"top"},[e("div",{staticClass:"main"},[e("div",{staticClass:"common-left"},[e("span",{staticClass:"common-chose-info",on:{click:function(e){return t.$refs.showFilterVillage.showDialog()}}},[e("i",{staticClass:"iconfont icondaqu"}),t._v(" "+t._s(t.choseVillageInfo.name)+" "),t.choseVillageInfo.vid?e("i",{staticClass:"close el-icon-circle-close",on:{click:function(e){return e.stopPropagation(),t.filterVillage({name:"全部项目",vid:""})}}}):t._e()]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchVal,expression:"searchVal"}],staticClass:"common-input",attrs:{type:"number",placeholder:"输入订单金额查询"},domProps:{value:t.searchVal},on:{input:function(e){e.target.composing||(t.searchVal=e.target.value)}}}),e("el-button",{staticClass:"common-button",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.keySearch(!0)}}},[t._v(" 查询 ")])],1)])]),e("div",{staticClass:"main-wp"},[e("div",{staticClass:"select-wp"},[e("el-select",{attrs:{clearable:"",placeholder:"请选择订单状态"},on:{change:t.tableLoad},model:{value:t.statusVal,callback:function(e){t.statusVal=e},expression:"statusVal"}},t._l(t.statusOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("el-date-picker",{attrs:{type:"datetime","picker-options":t.spickerOptions,placeholder:"请选择开始日期","value-format":"timestamp"},on:{change:t.tableLoad},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),t._v(" ~ "),e("el-date-picker",{attrs:{type:"datetime","default-time":"23:59:59","picker-options":t.epickerOptions,placeholder:"请选择截止日期","value-format":"timestamp"},on:{change:t.tableLoad},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}}),e("el-button",{attrs:{loading:t.isExport,type:"primary empty",round:""},on:{click:t.exportDetailExcel}},[t._v(" 导出Excel ")])],1),e("div",{staticClass:"table-wp"},[e("cus-table",{attrs:{datas:t.tableData,cusColums:t.columns,cusConf:t.conf,ispaging:!0},on:{sizeChange:t.sizeChange,currentChange:t.currentChange}}),e("div",{staticClass:"total"},[t._v(" 费用合计： "),e("span",{staticClass:"money"},[t._v(t._s(t.totalMoney)+"元")])])],1)]),e("filter-village",{ref:"showFilterVillage",attrs:{vid:t.choseVillageInfo.vid},on:{choseInfo:t.filterVillage}})],1)},i=[],o=(a("5948"),a("6216")),l={name:"stopCharge",data(){return{urlObj:{orders:this.$api.state.ParkManage.orders.url,status:this.$api.state.ParkManage.status.url},choseVillageInfo:{name:"全部项目",vid:""},searchVal:"",statusVal:"",statusOptions:[],startTime:"",endTime:"",tableData:[],columns:o.list,conf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},totalMoney:"0.00",isExport:!1}},computed:{spickerOptions(){return{disabledDate:t=>{if(t)return!!this.endTime&&t.getTime()>this.endTime}}},epickerOptions(){return{disabledDate:t=>{if(t)return!!this.startTime&&t.getTime()<this.startTime}}}},mounted(){let t=sessionStorage.getItem("vid"),e=sessionStorage.getItem("vname");t&&(this.choseVillageInfo.vid=t,this.choseVillageInfo.name=e),this.getStatus(),this.tableLoad()},methods:{filterVillage(t){this.choseVillageInfo.name=t.name,this.choseVillageInfo.vid=t.vid,this.searchVal="",this.statusVal="",this.startTime="",this.endTime="",this.conf={loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},this.tableLoad()},tableLoad(){this.conf.loadStatus=!0;let t={page:this.conf.curPage,limit:this.conf.limit,vid:this.choseVillageInfo.vid,money:this.searchVal,status:this.statusVal,stime:this.startTime?this.startTime/1e3:"",etime:this.endTime?this.endTime/1e3:""};this.$axios.post(this.urlObj.orders,t).then(t=>{200===t.Code?(this.totalMoney=_.round(Number(t.Data.money),2).toFixed(2),t.Data.lists.data.forEach(t=>{t.vname=t.village&&t.village.villagename?t.village.villagename:"--",t.cname=t.cars&&t.cars.name?t.cars.name:"--",t.gname=t.gate&&t.gate.name?t.gate.name:"--",t.gate.delete_time>0&&(t.gname=t.gname+"（闸机已删除）")}),this.conf.dataTotal=t.Data.lists.total,this.tableData=t.Data.lists.data,this.conf.loadStatus=!1,this.conf.emptyText=""):204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.datas=[],this.conf.emptyText=t.Message,this.conf.dataTotal=0,this.conf.loadStatus=!1)}).catch(()=>{this.datas=[],this.conf.emptyText="服务器连接失败...",this.conf.dataTotal=0,this.conf.loadStatus=!1})},keySearch(){this.conf={loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},this.tableLoad(!0)},sizeChange(t){this.conf.limit=t,this.tableLoad()},currentChange(t){this.conf.curPage=t,this.tableLoad()},getStatus(){this.$axios.post(this.urlObj.status).then(t=>{if(200===t.Code){let e=[];Object.keys(t.Data).forEach(a=>{e.push({label:t.Data[a],value:a})}),this.statusOptions=e}else{let e=t.Message?t.Message:"订单状态数据获取失败！";this.$message({type:"error",message:e})}}).catch(()=>{})},exportDetailExcel(){try{this.isExport=!0;let t={page:this.conf.curPage,limit:this.conf.limit,vid:this.choseVillageInfo.vid,money:this.searchVal,status:this.statusVal,stime:this.startTime?this.startTime/1e3:"",etime:this.endTime?this.endTime/1e3:"",is_excel:1};this.$axios.post(this.urlObj.orders,t).then(t=>{if(this.isExport=!1,200===t.Code){let e="临停收费订单表",s=["项目名称","车场名称","交费入口","交费金额","订单号","微信订单号","客户openid","交费时间","订单状态"],i=[];t.Data.forEach(t=>{let e=[t.village?t.village.villagename:"",t.cars?t.cars.name:"",t.gate?t.gate.name:"",t.money,t.order_no,t.wechat_order_no,t.openid,t.pay_time,t.status_text];i.push(e)}),Promise.all([a.e("chunk-3a869cfb"),a.e("chunk-2a5081b0"),a.e("chunk-3a96421c")]).then((()=>{let{export_json_to_excel:t}=a("628d");t(s,i,e)}).bind(null,a)).catch(a.oe),this.$notify({type:"success",title:"温馨提示",message:"导出报表成功",duration:1500})}else{let e=t.Message?t.Message:"订单数据获取失败！";this.$message({type:"error",message:e})}})}catch(t){this.isExport=!1,this.$notify({type:"error",title:"温馨提示",message:"导出报表失败",duration:1500})}}}},n=l,r=(a("e3ee"),a("1805")),c=Object(r["a"])(n,s,i,!1,null,null,null);e["default"]=c.exports},e29f:function(t,e,a){},e3ee:function(t,e,a){"use strict";a("e29f")}}]);