(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a9c06ce"],{"3d32":function(t,e,a){"use strict";a("9074")},"4b73":function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"发票/收据号","prop":"code","show":true},{"label":"房间号","prop":"roomnum","show":true},{"label":"姓名","prop":"cname","show":true,"color":"#999"},{"label":"实收金额","prop":"ssmoney","show":true},{"label":"缴费渠道","prop":"type_text","show":true,"color":"#999"},{"label":"小区名称","prop":"vname","show":true,"color":"#999"},{"label":"缴费内容","prop":"description","show":true,"color":"#999","width":180},{"label":"缴费日期","prop":"pay_time","show":true,"color":"#999","width":160}]}')},"8fd9":function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"交款人","prop":"cname","show":true},{"label":"开始时间","prop":"stime","show":true,"color":"#999"},{"label":"结束时间","prop":"etime","show":true,"color":"#999"},{"label":"金额","prop":"money","show":true,"color":"#ffcb3c"},{"label":"交款时间","prop":"create_time","show":true,"color":"#999"},{"label":"状态","prop":"status_text","show":true},{"label":"操作","width":120,"show":true,"type":"dropdown","items":[{"id":1,"name":"查看详情","hide":"xqhide","action":"detail","token":"empty"},{"id":2,"name":"撤回订单","hide":"chhide","action":"revocation","token":"empty"},{"id":3,"name":"打印订单","hide":"dyhide","action":"print","token":"empty"},{"id":4,"name":"重新交账","hide":"cxhide","action":"accountAgain","token":"empty"},{"id":5,"name":"删除交账","hide":"schide","action":"accountDel","token":"empty"}]}]}')},9074:function(t,e,a){},"96e5":function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"姓名","prop":"realname","show":true,"width":150},{"label":"房号","prop":"roomnum","show":true},{"label":"资源名称","prop":"resourceName","show":true,"color":"#999"},{"label":"装修状态","prop":"isdecorate","show":true,"color":"#999","width":100},{"label":"实收金额","prop":"money","show":true,"color":"#ffcb3c","width":100},{"label":"优惠金额","prop":"yhmoney","show":true,"color":"#999","width":100},{"label":"应收金额","prop":"allmoney","show":true,"color":"#ffcb3c","width":100},{"label":"订单状态","prop":"pstatus_text","show":true,"color":"#999"},{"label":"缴费状态","prop":"status_text","show":true,"color":"#999"},{"label":"收款方式","type":"select","prop":"type","show":true,"color":"#999","placeholder":"请选择付款方式","options":"paymentOptions","width":150,"action":"selectChange"},{"label":"收费员","prop":"sfname","show":true,"color":"#999"},{"label":"缴费内容","prop":"remark","show":true,"color":"#999","width":200},{"label":"发票收据","prop":"freceipt","show":true,"color":"#999","width":130},{"label":"订单号","prop":"sn","show":true,"width":210},{"label":"操作","width":120,"show":true,"type":"dropdown","items":[{"id":1,"name":"查看详情","hide":"xqhide","action":"detail","token":"Btn-qo8Iv6QW1E87pcb4LWAzgib1"},{"id":2,"name":"返销订单","hide":"fxhide","action":"buyBack","token":"Btn-Ca4BnJLT1Yl51cx9f0icJESk"},{"id":3,"name":"返销订单","hide":"fxhide1","action":"buyBack","token":"Btn-T5EkZJ9w1SSdGxxZy7ghN8Cb"},{"id":4,"name":"打印收据","hide":"dyhide","action":"print","token":"Btn-EQZwdMDo96McSceAy2nfIlUc"},{"id":5,"name":"下载发票","hide":"xzhide","action":"download","token":"Btn-BN3Vc7hMnHMQDNuVe8cXIfEd"},{"id":6,"name":"补开发票","hide":"bkhide","action":"invoiceAgain","token":"Btn-EsTEALx9O5hObI9sqapyHnfZ"},{"id":7,"name":"植入发票","hide":"zrhide","action":"implantation","token":"Btn-ETyvJyv8eFcpcVpYlejYQlWg"},{"id":8,"name":"补开收据","hide":"rbkhide","action":"receiptAgain","token":"Btn-7PnzvkTcDfAFOGNA9AlY0Q6i"},{"id":9,"name":"换票","hide":"hphide","action":"changeTicket","token":"Btn-gsa1YiWG8gLVgjf5N7FMIhCP"},{"id":10,"name":"收据二维码","hide":"qrhide","action":"showQrcode","token":"empty"}]}]}')},ae4d:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{attrs:{id:"order"}},[e("a",{ref:"adom",staticStyle:{display:"none"},attrs:{href:t.downloadUrl,target:"_blank"}}),e("div",{staticClass:"top"},[e("div",{staticClass:"main"},[e("div",{staticClass:"common-left"},[e("span",{staticClass:"common-chose-info",on:{click:function(e){return t.$refs.showFilterVillage.showDialog()}}},[e("i",{staticClass:"iconfont icondaqu"}),t._v(" "+t._s(t.choseVillageInfo.name)+" ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchVal,expression:"searchVal"}],staticClass:"common-input",attrs:{type:"text",placeholder:"请输入订单号码"},domProps:{value:t.searchVal},on:{input:function(e){e.target.composing||(t.searchVal=e.target.value)}}}),e("el-button",{staticClass:"common-button",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.keySearch}},[t._v(" 查询 ")])],1),e("div",{staticClass:"common-right"},[t.$menu.getters.judgeRole("Btn-yY0u4TL5cNaRnxLYWs4evUl9")?e("el-button",{staticClass:"common-button",attrs:{type:"primary",plain:"",icon:"iconfont iconxiugai"},on:{click:t.viewRecord}},[t._v(" 交款申请 ")]):t._e(),t.$menu.getters.judgeRole("Btn-eZyXwlQ65nwMH38X3HZIAqov")?e("span",{on:{click:t.exportExcel}},[e("workIcon",{staticClass:"common-right-icon",attrs:{name:"export",title:"导出"}})],1):t._e()],1)])]),e("div",{staticClass:"main-wp"},[e("div",{staticClass:"select-wp"},[e("el-select",{attrs:{clearable:"",placeholder:"请选择缴费状态"},on:{change:t.tableLoad},model:{value:t.chargeStatus,callback:function(e){t.chargeStatus=e},expression:"chargeStatus"}},t._l(t.statusOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("el-select",{attrs:{clearable:"",placeholder:"请选择缴费渠道"},on:{change:t.tableLoad},model:{value:t.chargeChannel,callback:function(e){t.chargeChannel=e},expression:"chargeChannel"}},t._l(t.channelOptions,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),e("el-select",{attrs:{clearable:"",placeholder:"请选择订单状态"},on:{change:t.tableLoad},model:{value:t.orderStatus,callback:function(e){t.orderStatus=e},expression:"orderStatus"}},t._l(t.orderOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("el-date-picker",{attrs:{type:"datetimerange",align:"center","value-format":"timestamp","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.tableLoad},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}})],1),e("div",{staticClass:"table-wp"},[e("cus-table",{ref:"cusTable",attrs:{datas:t.tableData,cusColums:t.columns,cusConf:t.conf,ispaging:!0},on:{sizeChange:t.sizeChange,currentChange:t.currentChange,buyBack:t.buyBack,selectChange:t.selectChange,detail:t.showDetial,print:t.printOrder,download:t.invoiceDownload,invoiceAgain:t.invoiceAgain,receiptAgain:t.receiptAgain,changeTicket:t.changeTicket,showQrcode:t.showQrcode,implantation:t.implantation}}),e("div",{staticClass:"total"},[e("span",{staticClass:"title"},[t._v("费用合计：")]),e("span",{staticClass:"name"},[t._v("实收")]),e("span",{staticClass:"official"},[t._v(t._s(t.money))]),e("span",{staticClass:"name"},[t._v("优惠")]),e("span",{staticClass:"discounts"},[t._v(t._s(t.yhmoney))]),e("span",{staticClass:"name"},[t._v("应收")]),e("span",{staticClass:"receb"},[t._v(t._s(t.allmoney))])])],1)]),e("filter-village",{ref:"showFilterVillage",attrs:{vid:t.choseVillageInfo.vid},on:{choseInfo:t.filterVillage}}),e("el-dialog",{staticClass:"orderDetail",attrs:{visible:t.showDetailPop,title:"订单缴费详情",width:"60%","close-on-click-modal":!0},on:{"update:visible":function(e){t.showDetailPop=e}}},[e("el-scrollbar",{staticStyle:{height:"100%"}},[e("div",{staticClass:"table-wp"},[e("cus-table",{attrs:{datas:t.popTableData,cusColums:t.popColumns,cusConf:t.popConf}})],1),e("div",{staticClass:"bt-wp"},[e("div",{staticClass:"total"},[t._v(" 费用合计： "),e("span",{staticClass:"name"},[t._v("实收")]),e("span",{staticClass:"value"},[t._v(t._s(t.realityMoney)+"元")]),e("span",{staticClass:"name"},[t._v("应收")]),e("span",{staticClass:"value ys"},[t._v(t._s(t.receivableMoney)+"元")])]),e("div",{staticClass:"remark"},[e("div",{staticClass:"content"},[e("span",{staticClass:"name"},[t._v("订单备注：")]),e("p",[t._v(" "+t._s(t.orderRemark)+" ")])])])]),e("div",{staticClass:"table-wp table2"},[e("div",{staticClass:"title"},[t._v("缴费明细")]),e("cus-table",{attrs:{datas:t.infoTableData,cusColums:t.infoColumns,cusConf:t.infoConf}})],1)])],1),e("el-dialog",{staticClass:"recordDialog",attrs:{visible:t.showRecordDialog,title:"交账订单明细",width:"80%","close-on-click-modal":!1},on:{"update:visible":function(e){t.showRecordDialog=e}}},[e("div",{staticClass:"date-filter"},[e("el-date-picker",{attrs:{readonly:t.dateRead,clearable:!1,type:"datetime",editable:!1,"picker-options":t.pickerOptions1(),"value-format":"timestamp",placeholder:"开始日期时间"},on:{change:t.sdateChange},model:{value:t.dateFilter[0],callback:function(e){t.$set(t.dateFilter,0,e)},expression:"dateFilter[0]"}}),t._v(" ~ "),e("el-date-picker",{attrs:{type:"datetime",readonly:t.loadStime,editable:!1,"value-format":"timestamp","picker-options":t.pickerOptions2(),placeholder:"结束日期时间"},on:{change:t.edateChange},model:{value:t.dateFilter[1],callback:function(e){t.$set(t.dateFilter,1,e)},expression:"dateFilter[1]"}}),e("el-button",{staticClass:"common-button",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchTable}},[t._v(" 查询 ")]),t.showSearchTable?e("el-button",{staticClass:"common-button",attrs:{type:"warning"},on:{click:t.auditHandle}},[t._v(" 提交 ")]):t._e(),t.showSearchTable?e("el-button",{staticClass:"record",attrs:{type:"primary",icon:"iconfont iconzu3638"},on:{click:t.goBack}},[t._v(" 交账记录 ")]):t._e()],1),e("div",{staticClass:"table-wp"},[t.showSearchTable&&!t.searchConf.loadStatus?e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.searchConf.loadStatus,expression:"searchConf.loadStatus"}],staticClass:"searchTable",attrs:{data:t.searchTableData.data,height:"calc(100% - 20px)","show-summary":"","summary-method":t.getSummaries,"element-loading-text":"数据获取中...","empty-text":(t.searchConf.emptyText,t.searchConf.emptyText)}},t._l(t.searchTableData.title,(function(t,a){return e("el-table-column",{key:a,attrs:{prop:t.prop,label:t.label}})})),1):e("cus-table",{attrs:{datas:t.recordTableData,cusColums:t.recordColumns,cusConf:t.recordConf,ispaging:!0},on:{sizeChange:t.recordSizeChange,currentChange:t.recordCurrentChange,print:t.printHandle,detail:t.recordInfo,revocation:t.recordDevocation,accountAgain:t.accountAgain,accountDel:t.accountDel}})],1)]),e("el-dialog",{staticClass:"infoDialog",attrs:{visible:t.showInfoDialog,title:"记录明细",width:"80%","close-on-click-modal":!0},on:{"update:visible":function(e){t.showInfoDialog=e}}},[e("el-scrollbar",{staticStyle:{height:"100%"}},[e("div",{staticClass:"table-wp"},[e("cus-table",{attrs:{datas:t.rcdInfoData,cusColums:t.rcdInfoColumns,cusConf:t.rcdInfoConf}})],1),e("div",{staticClass:"total"},[t._v(" 合计金额： "),e("span",{staticClass:"money"},[t._v(t._s(t.totalMoney)+"元")]),e("span",{staticClass:"num"},[t._v(" 共 "),e("span",{staticStyle:{color:"#3ebb75"}},[t._v(t._s(t.rcdInfoData.length))]),t._v(" 条记录 ")]),e("el-button",{attrs:{type:"primary empty",round:""},on:{click:t.exportDetailExcel}},[t._v(" 导出Excel ")])],1)])],1),e("el-dialog",{staticClass:"ticketChange",attrs:{visible:t.showTicketChange,title:"换票",width:"35%","close-on-click-modal":!0},on:{"update:visible":function(e){t.showTicketChange=e}}},[e("el-form",{ref:"changeForm",attrs:{model:t.changeForm,rules:t.changeRules,"hide-required-asterisk":!0}},[e("el-form-item",{attrs:{label:"发票代码",prop:"code"}},[e("el-input",{attrs:{placeholder:"请输入发票代码"},model:{value:t.changeForm.code,callback:function(e){t.$set(t.changeForm,"code",e)},expression:"changeForm.code"}})],1),e("el-form-item",{attrs:{label:"发票号码",prop:"number"}},[e("el-input",{attrs:{placeholder:"请输入发票号码"},model:{value:t.changeForm.number,callback:function(e){t.$set(t.changeForm,"number",e)},expression:"changeForm.number"}})],1),e("el-form-item",{attrs:{label:"发票类型",prop:"type"}},[e("el-select",{attrs:{clearable:"",placeholder:"请选择发票类型"},model:{value:t.changeForm.type,callback:function(e){t.$set(t.changeForm,"type",e)},expression:"changeForm.type"}},t._l(t.typeList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{loading:t.isCommit,type:"primary",round:""},on:{click:t.formSubmit}},[t._v(" 提交保存 ")]),e("el-button",{attrs:{loading:t.isCommit,type:"info",round:""},on:{click:function(e){t.showTicketChange=!1}}},[t._v(" 取消 ")])],1)],1),e("el-dialog",{staticClass:"ticketChange",attrs:{visible:t.showImplantDialog,title:"发票植入",width:"35%","close-on-click-modal":!0},on:{"update:visible":function(e){t.showImplantDialog=e}}},[e("el-form",{ref:"implantForm",attrs:{model:t.implantForm,rules:t.implantRules,"hide-required-asterisk":!0}},[e("el-form-item",{attrs:{label:"发票代码",prop:"code"}},[e("el-input",{attrs:{placeholder:"请输入发票代码"},model:{value:t.implantForm.code,callback:function(e){t.$set(t.implantForm,"code",e)},expression:"implantForm.code"}})],1),e("el-form-item",{attrs:{label:"发票号码",prop:"number"}},[e("el-input",{attrs:{placeholder:"请输入发票号码"},model:{value:t.implantForm.number,callback:function(e){t.$set(t.implantForm,"number",e)},expression:"implantForm.number"}})],1)],1),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{loading:t.isCommit,type:"primary",round:""},on:{click:t.implantSubmit}},[t._v(" 提交保存 ")]),e("el-button",{attrs:{loading:t.isCommit,type:"info",round:""},on:{click:function(e){t.showImplantDialog=!1}}},[t._v(" 取消 ")])],1)],1),e("el-dialog",{staticClass:"qrcodeDialog",attrs:{visible:t.showQrcodeDialog,title:"电子收据二维码",width:"30%","close-on-click-modal":!0},on:{"update:visible":function(e){t.showQrcodeDialog=e}}},[t.showQrcodeDialog&&t.qrSrc?e("div",{attrs:{id:"qrcode"}},[e("img",{attrs:{src:t.qrSrc,alt:""}})]):e("div",{staticStyle:{color:"#ccc","margin-top":"2.5rem"}},[t._v(" 正在生成二维码，请稍等 ")]),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{loading:t.isCommit,type:"primary",round:""},on:{click:t.saveImage}},[t._v(" 保存图片 ")]),e("el-button",{attrs:{loading:t.isCommit,type:"info",round:""},on:{click:function(e){t.showQrcodeDialog=!1}}},[t._v(" 取消 ")])],1)]),e("el-dialog",{staticClass:"fillDialog",attrs:{visible:t.showFillDialog,title:"补开收据",width:"28%","close-on-click-modal":!0},on:{"update:visible":function(e){t.showFillDialog=e}}},[e("div",{staticClass:"select-wp"},[e("div",{staticClass:"title"},[t._v("选择收据类型")]),e("el-select",{attrs:{disabled:3!=t.useReceiptType,placeholder:"请选择收据类型"},model:{value:t.receiptType,callback:function(e){t.receiptType=e},expression:"receiptType"}},[e("el-option",{attrs:{label:"电子收据",value:1}}),e("el-option",{attrs:{label:"纸质收据",value:2}})],1)],1),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{loading:t.isCommit,disabled:t.filldisabled,type:"primary",round:""},on:{click:t.fillSubmit}},[t._v(" 确认提交 ")]),e("el-button",{attrs:{loading:t.isCommit,disabled:t.filldisabled,type:"info",round:""},on:{click:function(e){t.showFillDialog=!1}}},[t._v(" 取消 ")])],1)]),e("el-dialog",{staticClass:"printDialog",attrs:{visible:t.showPrintDialog,title:"打印类型",width:"30%","close-on-click-modal":!0},on:{"update:visible":function(e){t.showPrintDialog=e}}},[e("el-radio",{attrs:{label:1},model:{value:t.radioVal,callback:function(e){t.radioVal=e},expression:"radioVal"}},[t._v("竖版打印")]),e("el-radio",{attrs:{label:2},model:{value:t.radioVal,callback:function(e){t.radioVal=e},expression:"radioVal"}},[t._v("横版打印")]),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",round:""},on:{click:t.recordPrint}},[t._v(" 确定 ")]),e("el-button",{attrs:{type:"info",round:""},on:{click:function(e){t.showPrintDialog=!1}}},[t._v(" 取消 ")])],1)],1),e("el-dialog",{staticClass:"auditDialog",attrs:{visible:t.showAuditDialog,title:"选择审批人",width:"35%","close-on-click-modal":!1},on:{"update:visible":function(e){t.showAuditDialog=e}}},[e("el-scrollbar",{staticStyle:{height:"100%"}},[e("el-form",{ref:"auditForm",attrs:{model:t.auditForm,rules:t.auditRules,"hide-required-asterisk":!0}},[t._l(t.auditForm.auditors,(function(a,s){return e("el-form-item",{key:s,attrs:{label:"审批人"+(s+1),prop:"auditors."+s+".auditor",rules:t.auditRules.auditor}},[e("el-select",{attrs:{filterable:"",remote:"","remote-method":e=>{t.remoteMethod(e,a)},loading:t.loading,placeholder:"请选择审批人"+(s+1)},model:{value:a.auditor,callback:function(e){t.$set(a,"auditor",e)},expression:"item.auditor"}},t._l(a.options,(function(t){return e("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1),0!=s?e("i",{staticClass:"el-icon-circle-close",on:{click:function(e){return t.delAuditor(s)}}}):t._e()],1)})),e("el-form-item",{staticClass:"addUser"},[e("div",{staticClass:"add",on:{click:t.addAuditor}},[t._v("添加审批人")])])],2)],1),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{loading:t.isCommit,type:"primary",round:""},on:{click:t.auditorSubmit}},[t._v(" 确认选择 ")]),e("el-button",{attrs:{loading:t.isCommit,type:"info",round:""},on:{click:function(e){t.showAuditDialog=!1}}},[t._v(" 取消 ")])],1)],1)],1)},i=[],o=(a("5948"),a("97ba"),a("cae3")),l=a("0f90"),r=a("4698"),n=a("96e5"),c=a("0a18"),h=a("8fd9"),d=a("4b73"),p=a("fdb8"),m=a("b029"),u={name:"order",components:{workIcon:r["a"]},data(){return{urlObj:{orderList:this.$api.state.Charge.orderList.url,getpaymenttype:this.$api.state.Charge.getpaymenttype.url,repairReceipt:this.$api.state.Charge.repairReceipt.url,issueReceipt:this.$api.state.Charge.issueReceipt.url,resalesn:this.$api.state.Charge.resalesn.url,changepaytype:this.$api.state.Charge.changepaytype.url,sndetail:this.$api.state.Charge.sndetail.url,repairinvoice:this.$api.state.Charge.repairinvoice.url,getfptype:this.$api.state.Charge.getfptype.url,changetickets:this.$api.state.Charge.changetickets.url,importsninvoice:this.$api.state.Charge.importsninvoice.url,getinvoiceinfo:this.$api.state.Charge.getinvoiceinfo.url,getwxqrcode:this.$api.state.Charge.getwxqrcode.url,accountList:this.$api.state.Setting.accountList.url,accountAudit:this.$api.state.Setting.accountAudit.url,orderDetail:this.$api.state.Setting.orderDetail.url,accountDetail:this.$api.state.Setting.accountDetail.url,revAccount:this.$api.state.Setting.revAccount.url,lastTime:this.$api.state.Setting.lastTime.url,accountdel:this.$api.state.Setting.accountdel.url,recordInfoList:this.$api.state.Setting.recordInfoList.url,getAuditors:this.$api.state.Public.getAuditors.url,getreceipttype:this.$api.state.Charge.getreceipttype.url},searchVal:"",choseVillageInfo:{name:"全部项目",vid:0},tableData:[],columns:n.list,conf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},chargeStatus:"",statusOptions:[{value:1,label:"未交"},{value:2,label:"已交"}],chargeChannel:"",channelOptions:[],orderPayments:[],orderStatus:"",orderOptions:[{value:1,label:"正常"},{value:2,label:"作废"}],dateValue:[],dateRead:!0,allmoney:"0.00",money:"0.00",yhmoney:"0.00",showDetailPop:!1,popTableData:[],popColumns:c.list,popConf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},infoTableData:[],infoColumns:p.list,infoConf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},realityMoney:"",receivableMoney:"",showRecordDialog:!1,recordTableData:[],recordColumns:h.list,recordConf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},lastTime:"",dateFilter:["",""],searchDate:[],showSearchTable:!1,searchTableData:[],searchConf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},showInfoDialog:!1,rcdInfoData:[],rcdInfoColumns:d.list,rcdInfoConf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},totalMoney:"0.00",showTicketChange:!1,currentTicket:"",changeForm:{code:"",number:"",type:""},changeRules:{code:[{required:!0,message:"请输入发票代码",trigger:"blur"}],number:[{required:!0,message:"请输入发票号码",trigger:"blur"}],type:[{required:!0,message:"请选择发票类型",trigger:"change"}]},typeList:[],isCommit:!1,downloadUrl:"",showQrcodeDialog:!1,qrSrc:"",downloadData:{url:"",icon:""},showPrintDialog:!1,printData:"",radioVal:1,showAuditDialog:!1,auditForm:{auditors:[{auditor:"",options:[]}]},auditRules:{auditor:[{required:!0,message:"选择审批人",trigger:"change"}]},loading:!1,isAgain:!1,againObj:"",orderRemark:"",showFillDialog:!1,useReceiptType:1,receiptType:1,loadStime:!1,filldisabled:!1,showImplantDialog:!1,currentImplant:"",implantForm:{code:"",number:""},implantRules:{code:[{required:!0,message:"请输入发票代码",trigger:"blur"}],number:[{required:!0,message:"请输入发票号码",trigger:"blur"}]}}},mounted(){let t=sessionStorage.getItem("vid"),e=sessionStorage.getItem("vname");t&&(this.choseVillageInfo.vid=t,this.choseVillageInfo.name=e);let a=new Date,s=a.getFullYear(),i=a.getMonth()+1,o=a.getDate(),l=new Date(s+"-"+i+"-"+o+" 00:00:00").getTime(),r=a.getTime();this.dateValue=[l,r],this.getPayments(),this.getPaymentType(),this.tableLoad()},methods:{filterVillage(t){this.choseVillageInfo.name=t.name,this.choseVillageInfo.vid=t.vid,this.searchVal="",this.chargeStatus="",this.chargeChannel="",this.channelOptions=[],this.orderStatus="",this.conf={loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},this.tableLoad(),this.getPaymentType()},keySearch(){this.searchVal&&(this.conf={loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},this.chargeStatus="",this.orderStatus="",this.chargeChannel="",this.dateValue=[]),this.tableLoad()},tableLoad(){this.conf.loadStatus=!0;let t={page:this.conf.curPage,limit:this.conf.limit,vid:this.choseVillageInfo.vid,is_page:1,status:this.chargeStatus,pstatus:this.orderStatus,pay_type:this.chargeChannel,keywords:this.searchVal};this.dateValue&&this.dateValue[0]&&this.dateValue[1]&&(t.stime=this.dateValue[0]/1e3,t.etime=this.dateValue[1]/1e3),this.$axios.post(this.urlObj.orderList,t).then(t=>{if(200===t.Code){if(t.Data.list.data&&t.Data.list.data.length>0){let e=this.orderPayments.map(t=>t.id);t.Data.list.data.forEach(t=>{t.resourceName=t.sndetails.map(t=>t.model_text).join("、"),t.paymentOptions=this.orderPayments,t.type=e.includes(t.type)?t.type:t.payment?t.payment.name:"",t.freceipt=t.fphm&&t.receipt?t.fphm+"/"+t.receipt:t.fphm?t.fphm:t.receipt?t.receipt:"",t.sfname=t.creater?t.creater.realname:"",t.xqhide=!1;let a=this.$menu.getters.judgeRole("Btn-Ca4BnJLT1Yl51cx9f0icJESk")&&this.$menu.getters.judgeRole("Btn-T5EkZJ9w1SSdGxxZy7ghN8Cb");t.fxhide=0==t.status||2==t.pstatus,t.fxhide1=!(0!=t.status&&2!=t.pstatus&&!a),t.dyhide=!t.receipt||1!=t.pstatus,t.xzhide=!t.fphm,t.bkhide=0==t.status||2==t.pstatus||0==t.open_receipt_fp,t.rbkhide=!(0!=t.status&&2!=t.pstatus&&!t.receipt),t.hphide=!t.receipt||1!=t.pstatus,t.qrhide=!t.receipt||1!=t.pstatus,t.zrhide=!!t.fpdm})}this.money=m["_"].round(t.Data.money,2),this.yhmoney=m["_"].round(t.Data.yhmoney,2),this.allmoney=m["_"].round(t.Data.allmoney,2),this.conf.dataTotal=t.Data.list.total,this.tableData=t.Data.list.data,this.conf.loadStatus=!1,this.conf.emptyText=""}else 204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.tableData=[],this.conf.emptyText=t.Message,this.conf.dataTotal=0,this.conf.loadStatus=!1)}).catch(()=>{this.tableData=[],this.conf.emptyText="服务器连接失败...",this.conf.dataTotal=0,this.conf.loadStatus=!1})},sizeChange(t){this.conf.limit=t,this.tableLoad()},currentChange(t){this.conf.curPage=t,this.tableLoad()},getPaymentType(){let t={vid:this.choseVillageInfo.vid};this.$axios.post(this.urlObj.getpaymenttype,t).then(t=>{if(200===t.Code)this.channelOptions=t.Data?t.Data:[];else{let e=t.Message?t.Message:"获取支付方式失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})},getPayments(){let t={vid:this.choseVillageInfo.vid,receipts:1};this.$axios.post(this.urlObj.getpaymenttype,t).then(t=>{if(200===t.Code)this.orderPayments=t.Data?t.Data:[];else{let e=t.Message?t.Message:"获取支付方式失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})},selectChange(t){let e={id:this.tableData[t].id,pay_type:this.tableData[t].type};this.$axios.post(this.urlObj.changepaytype,e).then(t=>{if(200===t.Code)this.$message({message:"支付方式修改成功！",type:"success"});else{let e=t.Message?t.Message:"支付方式修改失败！";this.$message({message:e,type:"error"})}this.tableLoad()}).catch(()=>{})},exportExcel(){let t={page:this.conf.curPage,limit:this.conf.limit,vid:this.choseVillageInfo.vid,is_page:0,status:this.chargeStatus,pstatus:this.orderStatus,pay_type:this.chargeChannel,stime:this.dateValue&&this.dateValue[0]?this.dateValue[0]/1e3:"",etime:this.dateValue&&this.dateValue[1]?this.dateValue[1]/1e3:"",keywords:this.searchVal};this.$axios.post(this.urlObj.orderList,t).then(t=>{if(200===t.Code){let e=t.Data.list&&t.Data.list.length>0?t.Data.list:[];this.exportDataHandle(e)}else{let e=t.Message?t.Message:"订单列表数据获取失败！";$message({type:"error",message:e})}})},exportDataHandle(t){try{Promise.all([a.e("chunk-2a5081b0"),a.e("chunk-2d0cefde")]).then((()=>{let{export_json_to_excel:e}=a("628d"),s=["姓名","房号","资源名称","装修状态","实收金额","优惠金额","应收金额","订单状态","缴费状态","收款方式","收费员","缴费内容","发票收据","订单号"],i=[];t.forEach(t=>{let e=[t.realname,t.roomnum,t.sndetails.map(t=>t.model_text).join("、"),t.isdecorate,Number(t.money)?Number(t.money):0,Number(t.yhmoney)?Number(t.yhmoney):0,Number(t.allmoney)?Number(t.allmoney):0,t.pstatus_text,1==t.status?"已交":"未交",t.payment?t.payment.name:"",t.creater?t.creater.realname:"",t.remark,t.receipt?t.receipt:"",t.sn];i.push(e)}),e(s,i,"订单数据表")}).bind(null,a)).catch(a.oe),this.$notify({type:"success",title:"温馨提示",message:"导出报表成功",duration:1500})}catch(e){this.$notify({type:"error",title:"温馨提示",message:"导出报表失败",duration:1500})}},buyBack(t){this.$confirm("此操作将返销当前订单，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e={id:t.id};this.$axios.post(this.urlObj.resalesn,e).then(t=>{if(200===t.Code)this.$message({message:"订单返销成功！",type:"success"}),this.tableLoad();else{let e=t.Message?t.Message:"订单返销失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})}).catch(()=>{})},detailTableLoad(t){this.popConf.loadStatus=!0,this.infoConf.loadStatus=!0,this.$axios.post(this.urlObj.sndetail,t).then(t=>{200===t.Code?(this.receivableMoney=t.Data.allmoney?t.Data.allmoney:"0.00",this.realityMoney=t.Data.money?t.Data.money:"0.00",t.Data.deatil&&t.Data.deatil.length>0&&t.Data.deatil.forEach(t=>{t.subname=t.subject?t.subject.name:"--",t.payname=t.payment?t.payment.name:"--",t.oname=t.owner?t.owner.realname:"--"}),t.Data.cost&&t.Data.cost.length>0&&t.Data.cost.forEach(t=>{t.subname=t.subject?t.subject.name:"--",t.remark=t.previewCostRepair?t.previewCostRepair.remarks:""}),this.orderRemark=t.Data.sn?t.Data.sn.bz:"",this.popTableData=t.Data.deatil?t.Data.deatil:[],this.infoTableData=t.Data.cost?t.Data.cost:[],this.popConf.loadStatus=!1,this.infoConf.loadStatus=!1,this.popConf.emptyText="",this.infoConf.emptyText=""):204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.popTableData=[],this.infoTableData=[],this.popConf.emptyText=t.Message,this.infoConf.emptyText=t.Message,this.popConf.dataTotal=0,this.infoConf.dataTotal=0,this.popConf.loadStatus=!1,this.infoConf.loadStatus=!1)}).catch(()=>{this.popTableData=[],this.infoTableData=[],this.popConf.emptyText="服务器连接失败...",this.infoConf.emptyText="服务器连接失败...",this.popConf.dataTotal=0,this.infoConf.dataTotal=0,this.popConf.loadStatus=!1,this.infoConf.loadStatus=!1})},showDetial(t){this.realityMoney="0.00",this.receivableMoney="0.00",this.orderRemark="",this.showDetailPop=!0,this.detailTableLoad({id:t.id})},printOrder(t){let e={id:t.id,type:2};this.$axios.post(this.urlObj.issueReceipt,e).then(e=>{if(200===e.Code)e.Data.id=t.id,o["a"].startLodop(e.Data);else{let t=e.Message?e.Message:"获取打印数据失败！";this.$message({message:t,type:"error"})}}).catch(()=>{})},invoiceDownload(t){this.$axios.post(this.urlObj.getinvoiceinfo,{id:t.id}).then(t=>{if(200===t.Code)this.downloadUrl=t.Data.pdf_url,this.$nextTick(()=>{let t=this.$refs.adom;t.click()});else{let e=t.Message?t.Message:"获取发票链接失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})},invoiceAgain(t){this.$confirm("确定要补开当前订单的发票吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.post(this.urlObj.repairinvoice,{id:t.id}).then(t=>{if(200===t.Code)this.$message({message:"补开发票成功！",type:"success"}),this.tableLoad();else{let e=t.Message?t.Message:"补开发票失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})}).catch(()=>{})},receiptAgain(t){this.currentRecipt=t,this.showFillDialog=!0,this.filldisabled=!0,this.$axios.post(this.urlObj.getreceipttype,{vid:t.vid}).then(t=>{if(200===t.Code)this.useReceiptType=t.Data.use_receipt_type,2==this.useReceiptType?this.receiptType=2:this.receiptType=1;else{let e=t.Message?t.Message:"获取收据使用类型失败！";this.$message({message:e,type:"error"})}this.filldisabled=!1}).catch(()=>{this.filldisabled=!1})},fillSubmit(){this.isCommit=!0;let t={id:this.currentRecipt.id,receipt_type:this.receiptType,vid:this.currentRecipt.vid};this.$axios.post(this.urlObj.repairReceipt,t).then(t=>{if(200===t.Code)this.$message({message:"补开收据成功！",type:"success"}),this.showFillDialog=!1,this.tableLoad();else{let e=t.Message?t.Message:"补开收据失败！";this.$message({message:e,type:"error"})}this.isCommit=!1}).catch(()=>{this.isCommit=!1})},changeTicket(t){this.currentTicket=t,this.$refs.changeForm&&this.$refs.changeForm.resetFields(),this.showTicketChange=!0,this.$axios.post(this.urlObj.getfptype).then(t=>{if(200===t.Code){let e=[];Object.keys(t.Data).forEach(a=>{let s={label:t.Data[a],value:a};e.push(s)}),this.typeList=e}else{let e=t.Message?t.Message:"获取发票类型失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})},formSubmit(){this.$refs.changeForm.validate(t=>{if(t){this.isCommit=!0;let t={id:this.currentTicket.id,fpdm:this.changeForm.code,fphm:this.changeForm.number,fp_type:this.changeForm.type};this.$axios.post(this.urlObj.changetickets,t).then(t=>{if(200===t.Code)this.$message({message:"换票成功！",type:"success"}),this.showTicketChange=!1,this.tableLoad();else{let e=t.Message?t.Message:"换票失败！";this.$message({message:e,type:"error"})}this.isCommit=!1}).catch(()=>{this.isCommit=!1})}})},showQrcode(t){this.qrSrc="",this.showQrcodeDialog=!0,this.$axios.post(this.urlObj.getwxqrcode,{id:t.id}).then(t=>{if(200===t.Code)this.qrSrc=t.Data;else{let e=t.Message?t.Message:"获取小程序二维码失败！";this.$message({type:"error",message:e})}}).catch(()=>{})},saveImage(){let t=document.querySelector("#qrcode img"),e=t.src,a=document.createElement("a"),s=new MouseEvent("click");a.download="电子收据二维码",a.href=e,a.dispatchEvent(s)},implantation(t){this.currentImplant=t,this.$refs.implantForm&&this.$refs.implantForm.resetFields(),this.showImplantDialog=!0},implantSubmit(){this.$refs.implantForm.validate(t=>{if(t){this.isCommit=!0;let t={id:this.currentImplant.id,fpdm:this.implantForm.code,fphm:this.implantForm.number};this.$axios.post(this.urlObj.importsninvoice,t).then(t=>{if(200===t.Code)this.$message({message:"植入发票成功！",type:"success"}),this.showImplantDialog=!1,this.tableLoad();else{let e=t.Message?t.Message:"植入发票失败！";this.$message({message:e,type:"error"})}this.isCommit=!1}).catch(()=>{this.isCommit=!1})}})},getSummaries(t){const{columns:e,data:a}=t,s=[];return e.forEach((t,e)=>{if(0===e)return void(s[e]="合计");let i=this.searchTableData.total?this.searchTableData.total.map(t=>t.prop):[];if(i.includes(t.property)){const i=a.map(e=>Number(e[t.property]));i.every(t=>isNaN(t))?s[e]="":(s[e]=i.reduce((t,e)=>{const a=Number(e);return isNaN(a)?t:m["_"].round(m["_"].add(Number(t),Number(e)),2).toFixed(2)},0),s[e])}else s[e]=""}),s},viewRecord(){this.dateFilter=["",""],this.showSearchTable=!1,this.showRecordDialog=!0,this.recordTableLoad(),this.getStartTime()},pickerOptions1(){let t,e,a,s,i,o,l,r=new Date,n=r.getMinutes(),c=(r.getHours()<10?"0"+r.getHours():r.getHours())+":",h=(n<10?"0"+n:n)+":",d=r.getSeconds()<10?"0"+r.getSeconds():r.getSeconds();this.dateFilter[1]&&(s=new Date(this.dateFilter[1]),t=s.getFullYear(),e=s.getMonth()<10?"0"+s.getMonth():s.getMonth(),a=s.getDate()<10?"0"+s.getDate():s.getDate(),i=(s.getHours()<10?"0"+s.getHours():s.getHours())+":",o=(s.getMinutes()<10?"0"+s.getMinutes():s.getMinutes())+":",l=s.getSeconds()<10?"0"+s.getSeconds():s.getSeconds());let p=r.toDateString()===new Date(this.dateFilter[0]).toDateString(),m=!!this.dateFilter[1]&&s.toDateString()===new Date(this.dateFilter[0]).toDateString();return{disabledDate:s=>this.dateFilter[1]?s.getTime()>new Date(t,e,a,0,0,0).getTime():s.getTime()>(new Date).getTime(),selectableRange:(()=>m?"00:00:00 - "+i+o+l:p?"00:00:00 -"+c+h+d:"00:00:00 - 23:59:59")()}},pickerOptions2(){let t,e,a,s,i,o,l,r=new Date,n=r.getMinutes(),c=(r.getHours()<10?"0"+r.getHours():r.getHours())+":",h=(n<10?"0"+n:n)+":",d=r.getSeconds()<10?"0"+r.getSeconds():r.getSeconds();this.dateFilter[0]&&(s=new Date(this.dateFilter[0]),t=s.getFullYear(),e=s.getMonth()<10?"0"+s.getMonth():s.getMonth(),a=s.getDate()<10?"0"+s.getDate():s.getDate(),i=(s.getHours()<10?"0"+s.getHours():s.getHours())+":",o=(s.getMinutes()<10?"0"+s.getMinutes():s.getMinutes())+":",l=s.getSeconds()<10?"0"+s.getSeconds():s.getSeconds());let p=r.toDateString()===new Date(this.dateFilter[1]).toDateString(),m=!!this.dateFilter[0]&&s.toDateString()===new Date(this.dateFilter[1]).toDateString();return{disabledDate:s=>s.getTime()>(new Date).getTime()||!!(this.dateFilter[0]&&s.getTime()<new Date(t,e,a,0,0,0).getTime()),selectableRange:(()=>p&&m?i+o+l+"-"+c+h+d:p?"00:00:00 -"+c+h+d:m?i+o+l+" - 23:59:59":"00:00:00 - 23:59:59")()}},sdateChange(){this.dateFilter[0]&&this.dateFilter[1]&&this.dateFilter[0]>this.dateFilter[1]&&(this.dateFilter[0]=this.dateFilter[1])},edateChange(){this.dateFilter[0]&&this.dateFilter[1]&&this.dateFilter[1]<this.dateFilter[1]&&(this.dateFilter[1]=this.dateFilter[0])},getStartTime(){this.loadStime=!0,this.dateFilter=["",""];let t={vid:this.choseVillageInfo.vid};this.$axios.post(this.urlObj.lastTime,t).then(t=>{if(200===t.Code)t.Data?(this.lastTime=new Date(t.Data).getTime(),this.dateFilter[0]=this.lastTime,this.dateRead=!0):this.dateRead=!1;else{let e=t.Message?t.Message:"获取上次提交时间失败！";this.$message({message:e,type:"error"})}this.loadStime=!1}).catch(()=>{this.loadStime=!1})},searchTable(){this.dateFilter&&this.dateFilter[0]&&this.dateFilter[1]?(this.searchDate=[this.dateFilter[0]/1e3,this.dateFilter[1]/1e3],this.showSearchTable=!0,this.searchTableLoad()):this.dateFilter[0]||this.dateFilter[1]?this.dateFilter[0]?this.$message({type:"warning",message:"请选择结束时间！"}):this.$message({type:"warning",message:"请选择开始时间！"}):this.$message({type:"warning",message:"请选择时间范围！"})},auditHandle(){this.isAgain=!1,this.$refs.auditForm&&this.$refs.auditForm.resetFields(),this.showAuditDialog=!0},remoteMethod(t,e){""!==t?(this.loading=!0,this.$axios.post(this.urlObj.getAuditors,{name:t}).then(t=>{if(200===t.Code)e.options=t.Data?t.Data:[];else{let e=t.Message?t.Message:"获取审批人数据失败！";this.$message({message:e,type:"error"})}this.loading=!1}).catch(()=>{this.loading=!1})):e.options=[]},addAuditor(){this.auditForm.auditors.push({auditor:""})},delAuditor(t){this.auditForm.auditors.splice(t,1)},auditorSubmit(){this.$refs.auditForm.validate(t=>{if(t){this.isCommit=!0;let t={vid:this.choseVillageInfo.vid,user:this.auditForm.auditors.map(t=>t.auditor)},e="";this.isAgain?(t.id=this.againObj.id,e=this.urlObj.accountAudit):(t.time=this.searchDate,e=this.urlObj.accountAudit),this.$axios.post(e,t).then(t=>{if(200===t.Code)this.$message({message:this.isAgain?"重新交账成功！":"提交成功！",type:"success"}),this.showSearchTable=!1,this.recordTableLoad(),this.getStartTime(),this.showAuditDialog=!1;else{let e=t.Message?t.Message:this.isAgain?"重新交账失败！":"提交失败！";this.$message({message:e,type:"error"})}this.isCommit=!1}).catch(()=>{this.isCommit=!1})}})},goBack(){this.recordTableData=[],this.recordConf={loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},this.showSearchTable=!1,this.recordTableLoad()},recordTableLoad(){this.recordConf.loadStatus=!0;let t={page:this.recordConf.curPage,limit:this.recordConf.limit,vid:this.choseVillageInfo.vid};this.$axios.post(this.urlObj.accountList,t).then(t=>{200===t.Code?(t.Data.data&&t.Data.data.length>0&&t.Data.data.forEach(t=>{t.cname=t.user.realname,t.xqhide=!1,t.chhide=0!=t.status&&4!=t.status,t.dyhide=3==t.status,t.cxhide=3!=t.status,t.schide=!t.is_del||3!=t.status}),this.recordConf.dataTotal=t.Data.total,this.recordTableData=t.Data.data,this.recordConf.loadStatus=!1,this.recordConf.emptyText=""):204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.recordTableData=[],this.recordConf.emptyText=t.Message,this.recordConf.dataTotal=0,this.recordConf.loadStatus=!1)}).catch(()=>{this.recordTableData=[],this.recordConf.emptyText="服务器连接失败...",this.recordConf.dataTotal=0,this.recordConf.loadStatus=!1})},recordSizeChange(t){this.recordConf.limit=t,this.recordTableLoad()},recordCurrentChange(t){this.recordConf.curPage=t,this.recordTableLoad()},printHandle(t){this.radioVal=1,this.printData=t,this.showPrintDialog=!0},recordPrint(){this.showPrintDialog=!1,this.$axios.post(this.urlObj.recordInfoList,{id:this.printData.id}).then(t=>{if(200===t.Code){let e="";if(t.Data.title&&t.Data.title.length>0)if(1==this.radioVal){let a=t.Data.total.map(t=>t.prop);t.Data.title.forEach(s=>{if("km"!=s.prop){let i="",o=0;t.Data.data.forEach(t=>{a.includes(s.prop)&&(o=m["_"].round(m["_"].add(Number(o),Number(t[s.prop])),2).toFixed(2)),i+=`<tr><td style="width:50%;text-align: center;height: 30px;border: 1px solid #aaa;font-size: 14px;">${t["km"]}</td>\n                        <td style="width:50%;text-align: center;height: 30px;border: 1px solid #aaa;font-size: 14px;">${t[s.prop]}</td></tr>\n                      `}),a.includes(s.prop)&&(i+=`<tr><td style="width:50%;text-align: center;height: 30px;border: 1px solid #aaa;font-size: 14px;">合计</td>\n                        <td style="width:50%;text-align: center;height: 30px;border: 1px solid #aaa;font-size: 14px;">${o}</td></tr>\n                      `),e=e+'<table style="width: 700px;margin-bottom: 20px;border: 1px solid #aaa; border-collapse:collapse;" border="0" cellpadding="0" cellspacing="0"><thead><tr style="text-align: center;height: 40px;line-height: 40px;font-weight: 600"><th style="width: 50%;text-align: center;border: 1px solid #aaa;font-size: 15px;line-height:60px;height: 60px;">科目</th>'+`<th style="width: 50%;text-align: center;border: 1px solid #aaa;font-size: 15px;line-height:60px;height: 60px;">${s.label}</th></tr></thead><tbody style="text-align: center">`+i+"</tbody></table>"}})}else{let a="";t.Data.title.forEach(t=>{a+=`<th style="text-align: center;border: 1px solid #aaa;font-size: 15px;line-height:60px;height: 60px;">${t.label}</th>`});let s="";t.Data.data.forEach(e=>{let a="";t.Data.title.forEach(t=>{a+=`<td style="text-align: center;height: 30px;border: 1px solid #aaa;font-size: 14px;">${e[t.prop]}</td>`}),s+=`<tr>${a}</tr>`});let i=t.Data.total.map(t=>t.prop),o='<td style="text-align: center;height: 30px;border: 1px solid #aaa;font-size: 14px;">合计</td>';t.Data.title.forEach(e=>{let a=0;i.includes(e.prop)&&"km"!=e.prop?(t.Data.data.forEach(t=>{a=m["_"].round(m["_"].add(Number(a),Number(t[e.prop])),2).toFixed(2)}),o+=`<td style="text-align: center;height: 30px;border: 1px solid #aaa;font-size: 14px;">${a}</td>`):"km"!=e.prop&&(o+='<td style="text-align: center;height: 30px;border: 1px solid #aaa;font-size: 14px;"></td>')}),s+=`<tr>${o}</tr>`;Object(l["a"])();e='<table style="width: 700px;margin-bottom: 20px;border: 1px solid #aaa; border-collapse:collapse;" border="0" cellpadding="0" cellspacing="0" class="table table-striped table-bordered table-hover "  ><thead><tr class="table-title-1" style="text-align: center;height: 40px;line-height: 40px;font-weight: 600">'+a+'</tr></thead><tbody style="text-align: center">'+s+"</tbody></table>"}else e='<div style="height: 50px;line-height: 40px;border: 1px solid #aaa;text-align:center;">暂无数据！</div>';let a='<div style="width: 700px;text-align: center;height: 30px;line-height: 30px;font-size: 18px;"><strong>'+this.choseVillageInfo.name+'&nbsp;&nbsp;交账日报</strong></div><div style="width: 700px;text-align: right;height: 40px;line-height: 40px;font-size: 13px;"><span>起止时间:'+this.printData.stime+"至"+this.printData.etime+"</span></div>"+e+'<div style="width: 700px;text-align: left;height: 30px;line-height: 30px;font-size: 14px;margin-top: 20px;"><strong>收据范围:&nbsp;&nbsp;&nbsp;</strong><span>'+t.Data.info.receipt+'</span></div><div style="width: 700px;text-align: left;height: 30px;line-height: 30px;font-size: 14px;"><strong>作废收据:&nbsp;&nbsp;&nbsp;</strong><span>'+t.Data.info.voidReceipt+'</span></div><div style="width: 700px;text-align: left;height: 30px;line-height: 30px;font-size: 14px;"><strong>交款人:&nbsp;&nbsp;&nbsp;</strong><span>'+t.Data.info.realname+'</span><strong style="margin-left: 18%">收款人:</strong><strong style="margin-left: 18%">收款日期:</strong></div>';LODOP.ADD_PRINT_TEXT(),LODOP.ADD_PRINT_HTM(30,30,5,"100%",a),LODOP.PREVIEW()}else{let e=t.Message?t.Message:"数据获取失败！";this.$message({type:"error",message:e})}}).catch(()=>{})},searchTableLoad(){this.searchConf.loadStatus=!0;let t={vid:this.choseVillageInfo.vid,start_time:this.dateFilter[0]/1e3,end_time:this.dateFilter[1]/1e3};this.$axios.post(this.urlObj.accountDetail,t).then(t=>{200===t.Code?(this.searchTableData=t.Data,this.searchConf.loadStatus=!1,this.searchConf.emptyText=""):204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.searchTableData=[],this.searchConf.emptyText=t.Message,this.searchConf.dataTotal=0,this.searchConf.loadStatus=!1)}).catch(()=>{this.searchTableData=[],this.searchConf.emptyText="服务器连接失败...",this.searchConf.dataTotal=0,this.searchConf.loadStatus=!1})},recordInfo(t){this.showInfoDialog=!0,this.rcdInfoConf.loadStatus=!0;let e={vid:this.choseVillageInfo.vid,id:t.id};this.$axios.post(this.urlObj.orderDetail,e).then(t=>{if(200===t.Code){if(t.Data&&t.Data.length>0){let e=0;t.Data.forEach(t=>{t.cname=t.snOrder.realname,t.code=t.snOrder.fphm&&t.snOrder.receipt?t.snOrder.fphm+"/"+t.snOrder.receipt:t.snOrder.fphm?t.snOrder.fphm:t.snOrder.receipt?t.snOrder.receipt:"",t.roomnum=t.snOrder.roomnum,t.ssmoney=t.snOrder.money,t.type_text=t.snOrder.payment?t.snOrder.payment.name:"",t.vname=t.village.villagename,t.description=t.snOrder.remark,t.pay_time=t.snOrder.pay_time,e=m["_"].add(Number(e),Number(t.ssmoney))}),this.totalMoney=m["_"].round(e,2)}this.rcdInfoData=t.Data,this.rcdInfoConf.loadStatus=!1,this.rcdInfoConf.emptyText=""}else 204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.rcdInfoData=[],this.rcdInfoConf.emptyText=t.Message,this.rcdInfoConf.dataTotal=0,this.rcdInfoConf.loadStatus=!1)}).catch(()=>{this.rcdInfoData=[],this.rcdInfoConf.emptyText="服务器连接失败...",this.rcdInfoConf.dataTotal=0,this.rcdInfoConf.loadStatus=!1})},recordDevocation(t){this.$confirm("确定要撤回当前交账记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e={id:t.id,vid:this.choseVillageInfo.vid,type:t.label};this.$axios.post(this.urlObj.revAccount,e).then(t=>{if(200===t.Code)this.$message({message:"交账记录撤回成功！",type:"success"}),this.recordTableLoad(),this.getStartTime();else{let e=t.Message?t.Message:"交账记录撤回失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})}).catch(()=>{})},accountAgain(t){this.isAgain=!0,this.againObj=t,this.$refs.auditForm&&this.$refs.auditForm.resetFields(),this.showAuditDialog=!0},accountDel(t){this.$confirm("确定要删除当前订单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e={id:t.id};this.$axios.post(this.urlObj.accountdel,e).then(t=>{if(200===t.Code)this.$message({message:"删除成功！",type:"success"}),this.recordTableLoad(),this.getStartTime();else{let e=t.Message?t.Message:"删除失败！";this.$message({message:e,type:"error"})}}).catch(()=>{})}).catch(()=>{})},exportDetailExcel(){try{let t="交账记录明细表",e=["发票/收据号","房间号","姓名","实收金额","缴费渠道","小区名称","缴费内容","缴费日期"],s=[];this.rcdInfoData.forEach(t=>{let e=[t.code,t.roomnum,t.cname,t.ssmoney,t.type_text,t.vname,t.description,t.pay_time];s.push(e)}),Promise.all([a.e("chunk-2a5081b0"),a.e("chunk-2d0cefde")]).then((()=>{let{export_json_to_excel:i}=a("628d");i(e,s,t)}).bind(null,a)).catch(a.oe),this.$notify({type:"success",title:"温馨提示",message:"导出报表成功",duration:1500})}catch(t){this.$notify({type:"error",title:"温馨提示",message:"导出报表失败",duration:1500})}}}},g=u,f=(a("3d32"),a("1805")),b=Object(f["a"])(g,s,i,!1,null,null,null);e["default"]=b.exports},fdb8:function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"科目名称","prop":"subname","show":true,"width":180},{"label":"实收","prop":"real_money","show":true,"color":"#69da61","width":130},{"label":"缴费内容","prop":"describe","show":true,"color":"#999"},{"label":"收款时间","prop":"pay_time","show":true,"color":"#999","width":180},{"label":"备注","prop":"remark","show":true}]}')}}]);