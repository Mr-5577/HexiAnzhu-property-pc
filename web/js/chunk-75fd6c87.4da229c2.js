(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75fd6c87"],{"400d":function(e,t,s){},"6a2f":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{attrs:{id:"category"}},[t("div",{staticClass:"left-wp"},[e._m(0),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],staticClass:"tree-wp"},[t("el-scrollbar",{staticStyle:{height:"100%"}},[t("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.typeList,"node-key":"id",props:e.defaultProps,accordion:"","show-checkbox":"","check-strictly":""},on:{"node-click":e.nodeClick,check:e.nodeCheck},scopedSlots:e._u([{key:"default",fn:function({node:s,data:i}){return t("span",{staticClass:"custom-tree-node"},[1===s.level&&"house"==i.icon?t("i",{staticClass:"iconfont iconzu3663"}):1===s.level&&"carmonth"==i.icon?t("i",{staticClass:"iconfont iconcheku"}):1===s.level&&"car"==i.icon?t("i",{staticClass:"iconfont icona-lujing443"}):1===s.level&&"water_ele_gas"==i.icon?t("i",{staticClass:"iconfont icona-zu4213"}):1===s.level&&"virtual"==i.icon?t("i",{staticClass:"iconfont iconqitaziyuan"}):e._e(),t("span",{staticClass:"label"},[e._v(" "+e._s(s.label)+" ")])])}}])})],1)],1),t("div",{staticClass:"btn-wp"},[e.$menu.getters.judgeRole("Btn-8xhROHzIohsbvlYaR7mtcXsW")?t("el-button",{attrs:{type:"primary",round:""},on:{click:e.openDialog}},[e._v(" 新增资源类型 ")]):e._e()],1)]),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"right-wp"},[e.currenTypeId?t("el-scrollbar",{staticStyle:{height:"100%"}},[t("div",{staticClass:"carport-wp"},[t("div",{staticClass:"carport-content"},[t("div",{staticClass:"title"},[t("i",{staticClass:"iconfont iconzu3663"}),t("span",[e._v("资源详情")])]),t("el-button",{attrs:{type:"primary",round:""},on:{click:e.logHandle}},[e._v(" 变更日志 ")])],1),t("div",{staticClass:"labels"},[t("div",{staticClass:"label"},[t("div",{staticClass:"text-wp"},[t("div",{staticClass:"number"},[e._v(e._s(e.typeInfo.name))]),t("div",{staticClass:"name"},[e._v("资源名称")])])]),t("div",{staticClass:"label"},[t("div",{staticClass:"text-wp"},[t("div",{staticClass:"number"},[e._v(e._s(e.typeInfo.p_name))]),t("div",{staticClass:"name"},[e._v("所属类别")])])])]),t("div",{staticClass:"mark-wp"},[t("div",{staticClass:"title"},[e._v("备注")]),t("el-input",{attrs:{type:"textarea",rows:5,readonly:"",resize:"none",placeholder:""},model:{value:e.typeInfo.remarks,callback:function(t){e.$set(e.typeInfo,"remarks",t)},expression:"typeInfo.remarks"}})],1)]),t("div",{staticClass:"btn-wp"},[t("div",{staticClass:"btn-group"},[e.$menu.getters.judgeRole("Btn-QdqAxCMgVV5SnzX0frGyQP0J")?t("el-button",{attrs:{type:"primary",round:""},on:{click:e.editHandle}},[e._v(" 修改资源类型 ")]):e._e(),t("el-button",{attrs:{loading:e.isStop,type:"warning",round:""},on:{click:e.typeStop}},[e._v(" 停用 ")])],1)])]):t("div",{staticClass:"empty"},[e._v("请在左侧选择资源类型！")])],1),t("el-dialog",{staticClass:"addDialog",attrs:{visible:e.isShow,title:"新增资源类别",width:"34%","close-on-click-modal":!1},on:{"update:visible":function(t){e.isShow=t}}},[t("el-scrollbar",{staticStyle:{height:"100%"}},[t("div",{staticClass:"input-wp"},[t("div",{staticClass:"input-item"},[t("div",{staticClass:"name"},[e._v("资源名称")]),t("el-input",{attrs:{placeholder:"请输入资源名称"},model:{value:e.typeName,callback:function(t){e.typeName=t},expression:"typeName"}})],1),t("div",{staticClass:"input-item"},[t("div",{staticClass:"name"},[e._v("资源类别")]),t("el-cascader",{attrs:{options:e.typeList,clearable:"",props:{checkStrictly:!0,value:"id"},"show-all-levels":!1,placeholder:"请选择资源类别"},model:{value:e.typeValue,callback:function(t){e.typeValue=t},expression:"typeValue"}})],1)]),t("div",{staticClass:"mark-wp"},[t("div",{staticClass:"title"},[e._v(" 备注 "),t("span",{staticStyle:{color:"#ccc","font-size":"0.6rem"}},[e._v("(选填)")])]),t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入备注",resize:"none"},model:{value:e.markValue,callback:function(t){e.markValue=t},expression:"markValue"}})],1)]),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{loading:e.isCommit,type:"primary",round:""},on:{click:e.confirm}},[e._v(" 提交保存 ")]),t("el-button",{attrs:{loading:e.isCommit,type:"info",round:""},on:{click:function(t){e.isShow=!1}}},[e._v(" 取消 ")])],1)],1),t("el-dialog",{staticClass:"editDialog",attrs:{visible:e.showEdit,title:"修改资源类型",width:"30%","close-on-click-modal":!1},on:{"update:visible":function(t){e.showEdit=t}}},[t("div",{staticClass:"input-wp"},[t("div",{staticClass:"input-item"},[t("div",{staticClass:"name"},[e._v("资源名称")]),t("el-input",{attrs:{placeholder:"请输入资源名称"},model:{value:e.etypeName,callback:function(t){e.etypeName=t},expression:"etypeName"}})],1)]),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{loading:e.isCommit,type:"primary",round:""},on:{click:e.editSubmit}},[e._v(" 提交保存 ")]),t("el-button",{attrs:{loading:e.isCommit,type:"info",round:""},on:{click:function(t){e.showEdit=!1}}},[e._v(" 取消 ")])],1)]),t("el-dialog",{staticClass:"logDialog",attrs:{visible:e.isShowLog,title:"变更日志",width:"40%"},on:{close:function(t){e.isShowLog=!1}}},[t("div",{staticClass:"log-wp"},[t("cus-table",{ref:"cusTable",attrs:{title:"客户变更日志",datas:e.logTableData,cusColums:e.logColumns,cusConf:e.logConf,ispaging:!0},on:{sizeChange:e.logSizeChange,currentChange:e.logCurrentChange}})],1)])],1)},a=[function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"title-wp"},[t("h3",[e._v("资源类型")])])}],o=(s("5948"),s("b7c9")),l={name:"category",data(){return{urlObj:{treeData:this.$api.state.Means.treeData.url,resourceType:this.$api.state.Means.resourceType.url,resourceInfo:this.$api.state.Means.resourceInfo.url,resourceAdd:this.$api.state.Means.resourceAdd.url,resourceStop:this.$api.state.Means.resourceStop.url,resourceOptions:this.$api.state.Means.resourceOptions.url,editresources:this.$api.state.Means.editresources.url,logData:this.$api.state.Means.logData.url},treeLoading:!1,isLoading:!1,typeList:[],typeInfo:{},currenTypeId:"",currenTypeName:"",isShow:!1,typeName:"",typeValue:[],markValue:"",isCommit:!1,isStop:!1,showEdit:!1,etypeName:"",defaultProps:{children:"children",label:"label",isLeaf:"isLeaf"},isShowLog:!1,logTableData:[],logColumns:o.list,logConf:{loadStatus:!1,emptyText:"",curPage:1,limit:10,dataTotal:0}}},created(){this.getResourceType()},methods:{nodeClick(e){this.$nextTick(()=>{e.disabled||(this.$refs.tree.setCheckedNodes([e]),this.currenTypeId=e.id,this.currenTypeName=e.label,this.getResourceInfo(e.id))})},nodeCheck(e){e.disabled||(this.$refs.tree.setCheckedNodes([e]),this.currenTypeId=e.id,this.currenTypeName=e.label,this.getResourceInfo(e.id))},getResourceType(){this.treeLoading=!0,this.$axios.post(this.urlObj.resourceType).then(e=>{200===e.Code?this.typeList=e.Data:this.$message({type:"error",message:"获取资源类别数据失败！"}),this.treeLoading=!1}).catch(e=>{this.$message({type:"error",message:"获取资源类别数据失败！"}),this.treeLoading=!1})},getResourceInfo(e){this.isLoading=!0,this.$axios.post(this.urlObj.resourceInfo,{id:e}).then(e=>{if(200===e.Code)this.typeInfo=e.Data;else{let t=e.Message?e.Message:"获取资源类别详情失败！";this.$message({type:"error",message:t})}this.isLoading=!1}).catch(e=>{this.$message({type:"error",message:"获取资源类别详情失败！"}),this.isLoading=!1})},openDialog(){this.typeName="",this.typeValue=[],this.markValue="",this.isShow=!0},close(){this.isShow=!1},confirm(){if(this.typeName.trim()||0!==this.typeValue.length)if(this.typeName.trim())if(0===this.typeValue.length)this.$message({type:"warning",message:"请选择资源类别！"});else{let e={name:this.typeName.trim(),pid:this.typeValue[this.typeValue.length-1],remarks:this.markValue.trim()};this.isCommit=!0,this.$axios.post(this.urlObj.resourceAdd,e).then(e=>{if(200===e.Code)this.$message({type:"success",message:"资源类别添加成功！"}),this.isShow=!1,this.getResourceType();else{let t=e.Message?e.Message:"数据提交失败！";this.$message({type:"error",message:t})}this.isCommit=!1}).catch(e=>{this.$message({type:"error",message:"数据提交失败！"}),this.isCommit=!1})}else this.$message({type:"warning",message:"请填写资源名称！"});else this.$message({type:"warning",message:"请填写资源名称和资源类别！"})},typeStop(){this.$confirm("此操作将删除当前资源类型, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.isStop=!0,this.$axios.post(this.urlObj.resourceStop,{id:this.currenTypeId}).then(e=>{if(200===e.Code)this.$message({type:"success",message:this.currenTypeName+"已停用！"}),this.getResourceType(),this.currenTypeId="",this.currenTypeName="";else{let t=e.Message?e.Message:"停用失败！";this.$message({type:"error",message:t})}this.isStop=!1}).catch(e=>{this.$message({type:"error",message:"停用失败！"}),this.isStop=!1})})},editHandle(){this.etypeName=this.typeInfo.name,this.showEdit=!0},editSubmit(){if(this.etypeName.trim()){this.isCommit=!0;let e={id:this.typeInfo.id,name:this.etypeName};this.$axios.post(this.urlObj.editresources,e).then(e=>{200===e.Code?(this.$message({type:"success",message:"资源类型修改成功！"}),this.showEdit=!1,this.getResourceType(),this.getResourceInfo(this.typeInfo.id)):this.$message({type:"error",message:"资源类型修改失败！"}),this.isCommit=!1}).catch(()=>{this.isCommit=!1})}else this.$message({type:"warning",message:"请输入资源名称"})},logHandle(){this.isShowLog=!0,this.getLogTableData()},getLogTableData(){this.logConf.loadStatus=!0;let e={page:this.logConf.curPage,limit:this.logConf.limit,id:this.currenTypeId,type:"resources_type"};this.$axios.post(this.urlObj.logData,e).then(e=>{if(200===e.Code){let t=[];e.Data.data.forEach(e=>{let s={createuser:e.createuser?e.createuser.realname:"",create_time:e.create_time,content:e.content};t.push(s)}),this.logTableData=t,this.logConf.loadStatus=!1,this.logConf.emptyText=""}else 204===e.Code?(this.$message({message:e.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.logTableData=[],this.logConf.emptyText=e.Message,this.logConf.dataTotal=0,this.logConf.loadStatus=!1)}).catch(()=>{this.logTableData=[],this.logConf.emptyText="服务器连接失败...",this.logConf.dataTotal=0,this.logConf.loadStatus=!1})},logSizeChange(e){this.logConf.limit=e,this.getLogTableData()},logCurrentChange(e){this.logConf.curPage=e,this.getLogTableData()}}},r=l,n=(s("9badc"),s("1805")),c=Object(n["a"])(r,i,a,!1,null,null,null);t["default"]=c.exports},"9badc":function(e,t,s){"use strict";s("400d")},b7c9:function(e){e.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"操作人","prop":"createuser","show":true},{"label":"操作时间","prop":"create_time","show":true},{"label":"变更日志","prop":"content","show":true}]}')}}]);