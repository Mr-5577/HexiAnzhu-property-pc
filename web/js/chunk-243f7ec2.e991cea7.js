(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-243f7ec2"],{"673b":function(e,t,a){"use strict";a("8ef0")},"6f23":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading||e.isCommit,expression:"isLoading || isCommit"}],attrs:{id:"inside-vehicle","element-loading-text":e.loadText}},[t("div",{staticClass:"main-wp"},[e.isLoading?e._e():t("el-scrollbar",{staticStyle:{height:"100%"}},[t("div",{staticClass:"main-ctn"},[t("div",{staticClass:"title"},[e._v("内部车管理")]),t("div",{staticClass:"input-wp"},[t("div",{staticClass:"input-item"},[t("div",{staticClass:"name"},[e._v("所属模块")]),t("el-select",{attrs:{clearable:"",placeholder:"请选择所属模块"},model:{value:e.smodule,callback:function(t){e.smodule=t},expression:"smodule"}},[t("el-option",{key:1,attrs:{label:"物业",value:1}}),t("el-option",{key:2,attrs:{label:"置业",value:2}})],1)],1),t("div",{staticClass:"input-item"},[t("div",{staticClass:"name"},[e._v("员工姓名")]),t("el-input",{attrs:{placeholder:"请输入员工姓名"},model:{value:e.uname,callback:function(t){e.uname=t},expression:"uname"}})],1),t("div",{staticClass:"input-item"},[t("div",{staticClass:"name"},[e._v("联系电话")]),t("el-input",{attrs:{type:"number",placeholder:"请输入联系电话"},model:{value:e.telVal,callback:function(t){e.telVal=t},expression:"telVal"}})],1),t("div",{staticClass:"input-item"},[t("div",{staticClass:"name"},[e._v("起止日期")]),t("el-date-picker",{attrs:{type:"daterange",align:"center","value-format":"timestamp","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dateValue,callback:function(t){e.dateValue=t},expression:"dateValue"}})],1),e._l(e.plateList,(function(a,i){return t("div",{key:i,staticClass:"input-item"},[t("div",{staticClass:"name"},[e._v(" 车牌号码 "),e.plateList.length>1?t("i",{staticClass:"del el-icon-circle-close",on:{click:function(t){return e.delPlate(i)}}}):e._e()]),t("el-input",{attrs:{placeholder:"请输入车牌号码"},model:{value:a.value,callback:function(t){e.$set(a,"value",t)},expression:"item.value"}})],1)})),t("div",{staticClass:"input-item"},[t("div",{staticClass:"name"}),t("div",{staticClass:"add-plate",on:{click:e.addPlate}},[t("i",{staticClass:"iconfont iconxinzeng"}),t("span",[e._v("添加车牌号码")])])])],2),t("div",{staticClass:"remark-wp"},[t("div",{staticClass:"name"},[e._v("备注信息")]),t("el-input",{attrs:{type:"textarea",rows:4,resize:"none",placeholder:"请输入备注"},model:{value:e.remarkVal,callback:function(t){e.remarkVal=t},expression:"remarkVal"}})],1),t("div",{staticClass:"title"},[e._v(" 选择项目 "),t("el-checkbox",{on:{change:e.allCheckChange},model:{value:e.allCheck,callback:function(t){e.allCheck=t},expression:"allCheck"}},[e._v(" ( 已选"+e._s(e.checkedVillages.length)+" ) ")])],1),t("div",{staticClass:"village-select"},[t("ul",{staticClass:"city-wp"},e._l(e.cityList,(function(a,i){return t("li",{key:i,staticClass:"city-item"},[t("div",{staticClass:"city-name"},[e._v(" "+e._s(a.label)+" "),t("el-checkbox",{on:{change:function(t){return e.cityCheckChange(t,i)}},model:{value:a.check,callback:function(t){e.$set(a,"check",t)},expression:"item.check"}},[e._v(" ( 已选"+e._s(a.checkedVillages.length)+" ) ")])],1),t("ul",{staticClass:"label-wp"},e._l(a.children,(function(a,s){return t("li",{key:s,staticClass:"label-item"},[t("div",{staticClass:"label"},[t("el-checkbox",{on:{change:function(t){return e.villageCheckChange(t,i)}},model:{value:a.check,callback:function(t){e.$set(a,"check",t)},expression:"itm.check"}}),t("span",[e._v(e._s(a.label))])],1)])})),0)])})),0)]),t("div",{staticClass:"btn-wp"},[t("el-button",{attrs:{type:"primary",round:""},on:{click:e.dataCommit}},[e._v(" 提交保存 ")]),t("el-button",{attrs:{type:"info",round:""},on:{click:e.dataReset}},[e._v("数据重置")])],1)])])],1)])},s=[],l=(a("5948"),{name:"insideVehicle",data(){return{urlObj:{treeData:this.$api.state.Means.treeData.url,addInsideCar:this.$api.state.Means.addInsideCar.url},isLoading:!1,isCommit:!1,loadText:"正在加载",smodule:1,uname:"",telVal:"",dateValue:"",plateList:[{value:""}],remarkVal:"",allCheck:!1,checkedVillage:[],cityList:[]}},computed:{checkedVillages(){let e=[];return this.cityList.forEach(t=>{e=e.concat(t.checkedVillages)}),e}},created(){this.getVillages()},methods:{getVillages(){this.loadText="正在加载",this.isLoading=!0,this.$axios.post(this.urlObj.treeData,{secondData:0}).then(e=>{if(200==e.Code)e.Data.forEach(e=>{e.check=!1,e.checkedVillages=[],e.children.length>0&&e.children.forEach(e=>{e.check=!1})}),this.cityList=e.Data;else{let t=e.Message?e.Message:"项目数据获取失败！";this.$message({type:"error",message:t})}this.isLoading=!1}).catch(e=>{this.isLoading=!1})},addPlate(){this.plateList.push({value:""})},delPlate(e){this.plateList.length>1&&this.plateList.splice(e,1)},allCheckChange(e){this.cityList.forEach(t=>{t.check=e,t.checkedVillages=e?t.children:[],t.children.forEach(t=>{t.check=e})})},cityCheckChange(e,t){this.cityList[t].checkedVillages=e?this.cityList[t].children:[],this.cityList[t].children.forEach(t=>{t.check=e});let a=[];this.cityList.forEach(e=>{e.check&&a.push(e)}),this.allCheck=a.length===this.cityList.length},villageCheckChange(e,t){let a=[];if(this.cityList[t].children.forEach(e=>{e.check&&a.push(e)}),this.cityList[t].checkedVillages=a,e){this.cityList[t].children.length===a.length&&(this.cityList[t].check=!0);let e=[];this.cityList.forEach(t=>{t.check&&e.push(t)}),e.length===this.cityList.length&&(this.allCheck=!0)}else this.allCheck=!1,this.cityList[t].check=!1},dataCommit(){let e={userplate:this.smodule,non_owner_name:this.uname.trim(),non_owner_tel:this.telVal,starttime:this.dateValue[0]?this.dateValue[0]/1e3:"",endtime:this.dateValue[1]?this.dateValue[1]/1e3:"",remark:this.remarkVal.trim(),plates:[],vids:[]};this.plateList.forEach(t=>{t.value.trim()&&e.plates.push(t.value.trim())}),this.cityList.forEach(t=>{t.children.length>0&&t.children.forEach(t=>{t.check&&e.vids.push(t.id)})});let t=[{name:"所属模块",value:e.userplate},{name:"员工姓名",value:e.non_owner_name},{name:"联系电话",value:e.non_owner_tel},{name:"起止日期",value:this.dateValue.length>0},{name:"车牌号码",value:e.plates.length>0},{name:"所属项目",value:e.vids.length>0}],a="";if(t.forEach(e=>{e.value||(a.length>0?a=a+"、"+e.name:a+=e.name)}),a.length>0)return a+="不能为空！",void this.$message({type:"warning",message:a});this.loadText="数据提交中",this.isCommit=!0,this.$axios.post(this.urlObj.addInsideCar,e).then(e=>{if(200===e.Code)this.$message({type:"success",message:"内部车辆添加成功！"}),this.dataReset();else{let t=e.Message?e.Message:"数据提交失败！";this.$message({type:"error",message:t})}this.isCommit=!1}).catch(e=>{this.$message({type:"error",message:"数据提交失败！"}),this.isCommit=!1})},dataReset(){this.uname="",this.telVal="",this.dateValue=[],this.remarkVal="",this.plateList=[{value:""}],this.cityList.forEach(e=>{e.check=!1,e.checkedVillages=[],e.children.forEach(e=>{e.check=!1})}),this.allCheck=!1}}}),c=l,n=(a("673b"),a("1805")),h=Object(n["a"])(c,i,s,!1,null,null,null);t["default"]=h.exports},"8ef0":function(e,t,a){}}]);