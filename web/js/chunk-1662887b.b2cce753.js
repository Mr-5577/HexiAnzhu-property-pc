(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1662887b"],{"3b84":function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"项目名称","prop":"vname","show":true,"color":"#999"},{"label":"科目名称","prop":"sname","show":true},{"label":"业主姓名","prop":"oname","show":true},{"label":"状态","prop":"status_text","show":true},{"label":"错误信息","prop":"error_msg","show":true,"color":"#999","width":180},{"label":"操作人","prop":"cname","show":true},{"label":"创建时间","prop":"create_time","show":true,"color":"#999","width":180},{"label":"操作","width":"150","type":"button","show":true,"btns":[{"name":"重新添加","type":"primary","size":"small","round":true,"hide":"sphide","action":"addAgain","role":"addAgain","token":"empty"}]}]}')},ab50:function(t,a,e){"use strict";e("ad3c")},ad3c:function(t,a,e){},ad7c:function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"楼栋","prop":"block","show":true},{"label":"单元","prop":"unit","show":true,"color":"#999"},{"label":"房号","prop":"roomnum","show":true,"color":"#69da61"},{"label":"业主姓名","prop":"owner_name","show":true},{"label":"业主电话","prop":"owner_tel","show":true,"color":"#999"}]}')},b842:function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"楼栋","prop":"block","show":true},{"label":"单元","prop":"unit","show":true,"color":"#999"},{"label":"房号","prop":"roomnum","show":true},{"label":"建筑面积","prop":"buildareas","show":true,"color":"#999"},{"label":"客户姓名","prop":"realname","show":true},{"label":"首次交房","prop":"turned","show":true,"color":"#999"},{"label":"物业费率","prop":"price","show":true,"color":"#69da61"},{"label":"更新截止","prop":"update_at","show":true,"color":"#999"}]}')},bc76:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t._self._c;t._self._setupProxy;return a("div",{attrs:{id:"arrearage"}},[t.showAdd?a("el-button",{staticClass:"empty",staticStyle:{position:"absolute",top:"0.3rem",right:"1.5rem","z-index":"1000"},attrs:{type:"primary",round:""},on:{click:t.goBack}},[t._v(" 返回 ")]):t._e(),t.showAdd?a("ChargeAdd",{attrs:{vid:t.currentObj.vid,currentUser:t.currentObj,checkeds:[t.currentObj.nodeid]}}):a("div",{staticClass:"main-wp"},[a("div",{staticClass:"left-wp"},[a("div",{staticClass:"header"},[a("div",{staticClass:"title"},[t._v("选择欠费目标")])]),a("div",{staticClass:"input-wp"},[a("div",{staticClass:"village"},[a("div",{staticClass:"name"},[t._v("欠费项目")]),a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择欠费项目"},on:{change:t.villageChange},model:{value:t.villageVal,callback:function(a){t.villageVal=a},expression:"villageVal"}},t._l(t.vilOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.villagename,value:t.id}})})),1)],1),a("div",{staticClass:"batch"},[a("div",{staticClass:"name"},[t._v("欠费批次")]),a("el-select",{attrs:{clearable:"",placeholder:"请选择欠费批次"},on:{change:t.batchChange},model:{value:t.batchVal,callback:function(a){t.batchVal=a},expression:"batchVal"}},t._l(t.batchOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("div",{staticClass:"subject"},[a("div",{staticClass:"name"},[t._v("欠费科目")]),a("el-select",{attrs:{clearable:"",placeholder:"请选择欠费科目"},on:{change:t.tableLoad},model:{value:t.subVal,callback:function(a){t.subVal=a},expression:"subVal"}},t._l(t.subOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)]),a("div",{staticClass:"date-wp"},[a("div",{staticClass:"name"},[t._v("欠费日期")]),a("el-date-picker",{attrs:{type:"date",placeholder:"开始日期","value-format":"yyyy-MM-dd","picker-options":t.startOptions},on:{change:t.startChange},model:{value:t.startDate,callback:function(a){t.startDate=a},expression:"startDate"}}),a("span",[t._v("-")]),a("el-date-picker",{attrs:{type:"month",placeholder:"结束日期","value-format":"yyyy-MM","picker-options":t.endOptions},on:{change:t.endChange},model:{value:t.endDate,callback:function(a){t.endDate=a},expression:"endDate"}})],1),t.$menu.getters.judgeRole("Btn-j5NhSVMm3wQcD9AXfYHL0quZ")?a("el-button",{attrs:{loading:t.isCommit,type:"primary",round:""},on:{click:t.generateOwe}},[t._v(" 生成欠费 ")]):t._e()],1),a("div",{staticClass:"right-wp"},[a("div",{staticClass:"header"},[a("span",{staticClass:"title"},[t._v("当前选中批次资源")]),a("el-switch",{attrs:{"active-color":"#3ebb75","inactive-color":"#f2f2f2"},model:{value:t.switchVal,callback:function(a){t.switchVal=a},expression:"switchVal"}}),a("div",{staticClass:"btn-switch"},[a("el-button",{attrs:{type:"info",round:"",plain:"",icon:"iconfont iconzu3638"},on:{click:function(a){return t.processCount()}}},[t._v(" 查看欠费状态 ")]),t.$menu.getters.judgeRole("Btn-X5HpnYgI41xfJwQ2aTmNDL07")?a("el-button",{attrs:{type:"primary",round:"",plain:"",icon:"iconfont iconzu3638"},on:{click:function(a){return t.dialogInit("log")}}},[t._v(" 更新记录 ")]):t._e(),t.$menu.getters.judgeRole("Btn-X5HpnYgI41xfJwQ2aTmNDL07")?a("el-button",{attrs:{type:"warning",round:"",plain:"",icon:"iconfont iconzu3638"},on:{click:t.failDialogInit}},[t._v(" 欠费失败记录 ")]):t._e()],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.switchVal,expression:"switchVal"}],staticClass:"table-wp"},[t.batchVal?a("cus-table",{attrs:{datas:t.tableData,cusColums:t.columns,cusConf:t.conf,ispaging:!0},on:{sizeChange:t.sizeChange,currentChange:t.currentChange}}):a("div",{staticClass:"tip"},[t._v("选择一个欠费批次查看！")])],1),a("div",{class:["btn-wp",t.switchVal?"":"hide"]},[t.$menu.getters.judgeRole("Btn-ykiH3PoNlr5n4FKWcbe8vLmq")?a("el-button",{attrs:{type:"success",round:"",plain:"",icon:"iconfont iconxinzeng"},on:{click:function(a){return t.dialogInit("add")}}},[t._v(" 新增批次 ")]):t._e(),t.$menu.getters.judgeRole("Btn-LfErTSYy3VCRWHZdltqvkxjs")?a("el-button",{attrs:{type:"warning",round:"",plain:"",icon:"iconfont iconpici"},on:{click:function(a){return t.dialogInit("manage")}}},[t._v(" 批次管理 ")]):t._e()],1)]),a("el-dialog",{staticClass:"addDialog",attrs:{visible:t.showAddPop,title:"新增批次",width:"60%","close-on-click-modal":!1},on:{"update:visible":function(a){t.showAddPop=a}}},[a("div",{staticClass:"select-wp"},[a("div",{staticClass:"select-item"},[a("div",{staticClass:"title"},[t._v("关联项目")]),a("el-select",{attrs:{clearable:"",placeholder:"请选择关联项目"},on:{change:t.villChange},model:{value:t.relatedVillage,callback:function(a){t.relatedVillage=a},expression:"relatedVillage"}},t._l(t.vilOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.villagename,value:t.id}})})),1)],1),a("div",{staticClass:"select-item"},[a("div",{staticClass:"title"},[t._v("楼栋")]),a("el-select",{attrs:{clearable:"",multiple:"","collapse-tags":"",placeholder:"请选择楼栋"},on:{change:t.buildChange},model:{value:t.buildVal,callback:function(a){t.buildVal=a},expression:"buildVal"}},t._l(t.buildOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.block,value:t.id}})})),1)],1),a("div",{staticClass:"select-item"},[a("div",{staticClass:"title"},[t._v("单元")]),a("el-select",{attrs:{clearable:"",multiple:"","collapse-tags":"",placeholder:"请选择单元"},on:{change:t.getDialogTable},model:{value:t.unitVal,callback:function(a){t.unitVal=a},expression:"unitVal"}},t._l(t.unitOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.block+"/"+t.unit,value:t.id}})})),1)],1),a("div",{staticClass:"line"}),a("div",{staticClass:"select-item"},[a("div",{staticClass:"title"},[t._v("批次名称")]),a("el-input",{attrs:{placeholder:"请输入批次名称"},model:{value:t.batchName,callback:function(a){t.batchName=a},expression:"batchName"}})],1),a("div",{staticClass:"select-item"},[a("div",{staticClass:"title"},[t._v("首次交房时间")]),a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:t.firstDate,callback:function(a){t.firstDate=a},expression:"firstDate"}})],1)]),a("div",{staticClass:"table-wp"},[a("cus-table",{attrs:{datas:t.dialogTable.tableData,cusColums:t.dialogTable.columns,cusConf:t.dialogTable.conf,ispaging:!0,check:!0},on:{sizeChange:t.dialogSizeChange,currentChange:t.dialogCurrentChange,selectionChange:t.selectionChange}})],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{disabled:!(t.relatedVillage&&t.batchName&&t.firstDate&&t.tableSelected.length>0),loading:t.isCommit,type:"primary",round:""},on:{click:t.confirm}},[t._v(" 提交保存 ")]),a("el-button",{attrs:{loading:t.isCommit,type:"info",round:""},on:{click:function(a){t.showAddPop=!1}}},[t._v(" 取消 ")])],1)]),a("el-dialog",{staticClass:"manageDialog",attrs:{visible:t.showManagePop,title:"批次管理",width:"50%","close-on-click-modal":!0},on:{"update:visible":function(a){t.showManagePop=a}}},[a("div",{staticClass:"table-wp"},[a("cus-table",{attrs:{datas:t.dialogTable.tableData,cusColums:t.dialogTable.columns,cusConf:t.dialogTable.conf,ispaging:!0},on:{sizeChange:t.dialogSizeChange,currentChange:t.dialogCurrentChange,addSource:t.addSource}})],1)]),a("el-dialog",{staticClass:"logDialog",attrs:{visible:t.showLogPop,title:"更新记录",width:"50%","close-on-click-modal":!0},on:{"update:visible":function(a){t.showLogPop=a}}},[a("div",{staticClass:"table-wp"},[a("cus-table",{attrs:{datas:t.dialogTable.tableData,cusColums:t.dialogTable.columns,cusConf:t.dialogTable.conf,ispaging:!0},on:{sizeChange:t.dialogSizeChange,currentChange:t.dialogCurrentChange}})],1)]),a("el-dialog",{staticClass:"addDialog house",attrs:{visible:t.showAddSource,title:"添加房源",width:"60%","close-on-click-modal":!1},on:{"update:visible":function(a){t.showAddSource=a}}},[a("div",{staticClass:"select-wp"},[a("div",{staticClass:"select-item"},[a("div",{staticClass:"title"},[t._v("关联项目")]),a("el-select",{attrs:{clearable:"",disabled:"",placeholder:"请选择关联项目"},model:{value:t.relatedVillage,callback:function(a){t.relatedVillage=a},expression:"relatedVillage"}},t._l(t.vilOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.villagename,value:t.id}})})),1)],1),a("div",{staticClass:"select-item"},[a("div",{staticClass:"title"},[t._v("楼栋")]),a("el-select",{attrs:{clearable:"",multiple:"","collapse-tags":"",placeholder:"请选择楼栋"},on:{change:t.addBuildChange},model:{value:t.buildVal,callback:function(a){t.buildVal=a},expression:"buildVal"}},t._l(t.buildOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.block,value:t.id}})})),1)],1),a("div",{staticClass:"select-item"},[a("div",{staticClass:"title"},[t._v("单元")]),a("el-select",{attrs:{clearable:"",multiple:"","collapse-tags":"",placeholder:"请选择单元"},on:{change:t.getHouseTables},model:{value:t.unitVal,callback:function(a){t.unitVal=a},expression:"unitVal"}},t._l(t.unitOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.block+"/"+t.unit,value:t.id}})})),1)],1)]),a("div",{staticClass:"table-wp"},[a("cus-table",{attrs:{datas:t.addTableData,cusColums:t.addColumns,cusConf:t.addConf,ispaging:!0,check:!0},on:{sizeChange:t.addSizeChange,currentChange:t.addCurrentChange,selectionChange:t.addSelectionChange}})],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{disabled:0==t.addTableSelected.length,loading:t.isCommit,type:"primary",round:""},on:{click:t.addSubmit}},[t._v(" 提交保存 ")]),a("el-button",{attrs:{loading:t.isCommit,type:"info",round:""},on:{click:function(a){t.showAddSource=!1}}},[t._v(" 取消 ")])],1)]),a("el-dialog",{staticClass:"failDialog",attrs:{visible:t.showFailDialog,title:"欠费失败记录",width:"50%","close-on-click-modal":!0},on:{"update:visible":function(a){t.showFailDialog=a}}},[a("div",{staticClass:"table-wp"},[a("cus-table",{attrs:{datas:t.failTableData,cusColums:t.failColumns,cusConf:t.failConf,ispaging:!0},on:{sizeChange:t.failSizeChange,currentChange:t.failCurrentChange,addAgain:t.addAgain}})],1)])],1)],1)},i=[],l=(e("5948"),e("b842")),o=e("ad7c"),n=e("d590"),r=e("cd16"),d=e("3b84"),c=e("8bde"),h={name:"arrearages",components:{ChargeAdd:c["a"]},data(){return{urlObj:{userVillage:this.$api.state.Public.userVillage.url,subjectList:this.$api.state.Setting.subjectList.url,batchList:this.$api.state.Setting.batchList.url,batchRooms:this.$api.state.Setting.batchRooms.url,generateArrears:this.$api.state.Setting.generateArrears.url,batchLog:this.$api.state.Setting.batchLog.url,batchManage:this.$api.state.Setting.getBatchData.url,addBatch:this.$api.state.Setting.addBatch.url,errorLog:this.$api.state.Setting.errorLog.url,updateFail:this.$api.state.Setting.updateFail.url,addrooms:this.$api.state.Setting.addrooms.url,buildOfVillage:this.$api.state.Public.buildOfVillage.url,searchUnit:this.$api.state.Public.searchUnit.url,arrearageProcess:this.$api.state.Setting.processCounts.url},tableData:[],columns:l.list,conf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},tableSelected:[],villageVal:"",vilOptions:[],batchVal:"",batchOptions:[],subVal:"",subOptions:[],startDate:"",endDate:"",startOptions:{disabledDate:t=>!1},endOptions:{disabledDate:t=>!1},switchVal:!0,showAddPop:!1,showManagePop:!1,showLogPop:!1,dialogTable:{tableData:[],columns:o.list,conf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0}},isCommit:!1,type:"",relatedVillage:"",batchName:"",firstDate:"",currentUrl:"",showFailDialog:!1,failTableData:[],failColumns:d.list,failConf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},showAdd:!1,currentObj:{},buildVal:[],buildOptions:[],unitVal:[],unitOptions:[],showAddSource:!1,addTableData:[],addColumns:o.list,addConf:{loadStatus:!1,emptyText:"",curPage:1,limit:100,dataTotal:0},addTableSelected:[],addIndex:"",showProcess:"ture"}},computed:{vid(){return this.$store.state.vid}},created(){this.getUserVillage()},methods:{getUserVillage(){this.$axios.post(this.urlObj.userVillage).then(t=>{if(200===t.Code)this.vilOptions=t.Data,this.vid&&(this.villageVal=Number(this.vid),this.getBatchData(),this.getSubjectData());else{let a=t.Message?t.Message:"获取项目数据失败!";this.$message({type:"error",message:a})}}).catch(()=>{this.$message({type:"error",message:"获取项目数据失败!"})})},getBatchData(){let t={vid:this.villageVal};this.$axios.post(this.urlObj.batchList,t).then(t=>{if(200===t.Code)this.batchOptions=t.Data;else{let a=t.Message?t.Message:"获取批次数据失败!";this.$message({type:"error",message:a})}}).catch(()=>{this.$message({type:"error",message:"获取批次数据失败!"})})},getSubjectData(){let t={vid:this.villageVal};this.$axios.post(this.urlObj.subjectList,t).then(t=>{if(200===t.Code)this.subOptions=t.Data;else{let a=t.Message?t.Message:"获取科目数据失败!";this.$message({type:"error",message:a})}}).catch(()=>{this.$message({type:"error",message:"获取科目数据失败!"})})},villageChange(t){this.batchVal="",this.batchOptions=[],this.subVal="",this.subOptions=[],t&&(this.getBatchData(),this.getSubjectData())},batchChange(t){this.tableData=[],t&&(this.conf={loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0},this.tableLoad())},startChange(){this.startDate?this.endOptions={disabledDate:t=>{if(t)return t.getTime()<new Date(this.startDate).getTime()}}:this.endOptions={disabledDate:t=>!1}},endChange(){if(this.endDate){let t=this.endDate.split("-")[0],a=this.endDate.split("-")[1],e=new Date(t,a,0).getDate(),s=new Date(t,a-1,e,59,59,59).getTime();this.startOptions={disabledDate:t=>{if(t)return t.getTime()>s}}}else this.startOptions={disabledDate:t=>!1}},tableLoad(){this.conf.loadStatus=!0;let t={page:this.conf.curPage,limit:this.conf.limit,vid:this.villageVal,batch_id:this.batchVal,subject_id:this.subVal};this.$axios.post(this.urlObj.batchRooms,t).then(t=>{200===t.Code?(this.conf.dataTotal=t.Data.total,this.tableData=t.Data.data,this.conf.loadStatus=!1,this.conf.emptyText=""):204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.tableData=[],this.conf.emptyText=t.Message,this.conf.dataTotal=0,this.conf.loadStatus=!1)}).catch(()=>{this.tableData=[],this.conf.emptyText="服务器连接失败...",this.conf.dataTotal=0,this.conf.loadStatus=!1})},sizeChange(t){this.conf.limit=t,this.tableLoad()},currentChange(t){this.conf.curPage=t,this.tableLoad()},selectionChange(t){this.tableSelected=t},generateOwe(){if(this.villageVal&&this.startDate&&this.endDate&&this.subVal)this.$confirm("确定要生成欠费吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.isCommit=!0;let t=this.endDate.split("-")[0],a=this.endDate.split("-")[1],e=new Date(t,a,0).getDate(),s={batch_id:this.batchVal?this.batchVal:"",vid:this.villageVal,time:[this.startDate,t+"-"+a+"-"+e],subject_id:this.subVal};this.$axios.post(this.urlObj.generateArrears,s).then(t=>{if(200===t.Code)this.$message({type:"success",message:"生成欠费成功！"}),this.startDate="",this.endDate="",this.subVal="",this.subOptions=[],this.batchVal="",this.batchOptions=[],this.villageVal="";else{let a=t.Message?t.Message:"生成欠费失败!";this.$message({type:"error",message:a})}this.isCommit=!1}).catch(()=>{this.$message({type:"error",message:"生成欠费失败!"}),this.isCommit=!1})}).catch(()=>{});else{let t=[];this.villageVal||t.push("欠费项目"),this.subVal||t.push("欠费科目"),this.startDate||t.push("欠费开始日期"),this.endDate||t.push("欠费结束日期"),this.$message({type:"warning",message:"请选择"+t.join("、")})}},getDialogTable(){this.dialogTable.conf.loadStatus=!0;let t={page:this.dialogTable.conf.curPage,limit:this.dialogTable.conf.limit,vid:this.vid,b_id:this.buildVal,unit_id:this.unitVal};"add"==this.type&&(t.vid=this.relatedVillage),this.$axios.post(this.currentUrl,t).then(t=>{200===t.Code?(this.dialogTable.conf.dataTotal=t.Data.total,this.dialogTable.tableData=t.Data.data,this.dialogTable.conf.loadStatus=!1,this.dialogTable.conf.emptyText=""):204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.dialogTable.tableData=[],this.dialogTable.conf.emptyText=t.Message,this.dialogTable.conf.dataTotal=0,this.dialogTable.conf.loadStatus=!1)}).catch(()=>{this.dialogTable.tableData=[],this.dialogTable.conf.emptyText="服务器连接失败...",this.dialogTable.conf.dataTotal=0,this.dialogTable.conf.loadStatus=!1})},dialogSizeChange(t){this.dialogTable.conf.limit=t,this.getDialogTable()},dialogCurrentChange(t){this.dialogTable.conf.curPage=t,this.getDialogTable()},dialogInit(t){switch(this.type=t,this.dialogTable={tableData:[],columns:o.list,conf:{loadStatus:!1,emptyText:"",curPage:1,limit:20,dataTotal:0}},t){case"add":this.dialogTable.conf={loadStatus:!1,emptyText:"",curPage:1,limit:100,dataTotal:0},this.currentUrl=this.urlObj.batchRooms,this.dialogTable.columns=o.list,this.relatedVillage=Number(this.vid),this.buildVal=[],this.buildOptions=[],this.unitVal=[],this.unitOptions=[],this.getBuildData(),this.showAddPop=!0;break;case"manage":this.currentUrl=this.urlObj.batchManage,this.dialogTable.columns=n.list,this.showManagePop=!0;break;case"log":this.currentUrl=this.urlObj.batchLog,this.dialogTable.columns=r.list,this.showLogPop=!0;break}this.getDialogTable()},confirm(){this.isCommit=!0;let t={interactive_time:this.firstDate,vid:this.relatedVillage,name:this.batchName,rooms:this.tableSelected.map(t=>t.id)};this.$axios.post(this.urlObj.addBatch,t).then(t=>{if(200===t.Code)this.$message({type:"success",message:"批次新增成功！"}),this.batchName="",this.firstDate="",this.getDialogTable(),this.getBatchData();else{let a=t.Message?t.Message:"批次新增失败!";this.$message({type:"error",message:a})}this.isCommit=!1}).catch(()=>{this.$message({type:"error",message:"批次新增失败!"}),this.isCommit=!1})},failDialogInit(){this.showFailDialog=!0,this.failTableLoad()},failTableLoad(){this.failConf.loadStatus=!0;let t={page:this.failConf.curPage,limit:this.failConf.limit,vid:this.vid};this.$axios.post(this.urlObj.errorLog,t).then(t=>{200===t.Code?(t.Data.data&&t.Data.data.length>0&&t.Data.data.forEach(t=>{t.vname=t.village?t.village.villagename:"--",t.sname=t.subject?t.subject.name:"--",t.oname=t.owner?t.owner.realname:"--",t.cname=t.createuser?t.createuser.realname:"--",t.currentData={id:t.resources.id,oid:t.oid,type:t.resources_model_id}}),this.failConf.dataTotal=t.Data.total,this.failTableData=t.Data.data,this.failConf.loadStatus=!1,this.failConf.emptyText=""):204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.failTableData=[],this.failConf.emptyText=t.Message,this.failConf.dataTotal=0,this.failConf.loadStatus=!1)}).catch(()=>{this.failTableData=[],this.failConf.emptyText="服务器连接失败...",this.failConf.dataTotal=0,this.failConf.loadStatus=!1})},failSizeChange(t){this.failConf.limit=t,this.tableLoad()},failCurrentChange(t){this.failConf.curPage=t,this.failTableLoad()},addAgain(t){this.currentObj={vid:this.failTableData[t].village.id,oid:this.failTableData[t].oid,id:this.failTableData[t].resources_model_id,type:this.failTableData[t].resources_model_type,subid:this.failTableData[t].subject_id,nodeid:this.failTableData[t].nodeid},this.showAdd=!0,this.$axios.post(this.urlObj.updateFail,{id:this.failTableData[t].id}).then(t=>{if(200!=t.Code){let a=t.Message?t.Message:"更新欠费操作失败！";this.$message({type:"error",message:a})}}).catch(()=>{})},goBack(){this.showAdd=!1,this.failTableLoad()},getBuildData(){this.$axios.post(this.urlObj.buildOfVillage,{vid:this.relatedVillage}).then(t=>{if(200===t.Code)this.buildOptions=t.Data?t.Data:[];else{let a=t.Message?t.Message:"获取楼栋数据失败!";this.$message({type:"error",message:a})}}).catch(()=>{})},getUnitData(){this.$axios.post(this.urlObj.searchUnit,{bids:this.buildVal}).then(t=>{if(200===t.Code)this.unitOptions=t.Data?t.Data:[];else{let a=t.Message?t.Message:"获取单元数据失败!";this.$message({type:"error",message:a})}}).catch(()=>{})},villChange(t){this.buildVal=[],this.buildOptions=[],this.unitVal=[],this.unitOptions=[],t&&this.getBuildData(),this.getDialogTable()},buildChange(t){this.unitVal=[],this.unitOptions=[],t&&this.getUnitData(),this.getDialogTable()},addSource(t){this.addIndex=t,this.relatedVillage=Number(this.dialogTable.tableData[t].vid),this.buildVal=[],this.buildOptions=[],this.unitVal=[],this.unitOptions=[],this.getBuildData(),this.getHouseTables(),this.showAddSource=!0},getHouseTables(){this.addConf.loadStatus=!0;let t={page:this.addConf.curPage,limit:this.addConf.limit,vid:this.relatedVillage,b_id:this.buildVal,unit_id:this.unitVal};this.$axios.post(this.urlObj.batchRooms,t).then(t=>{200===t.Code?(this.addConf.dataTotal=t.Data.total,this.addTableData=t.Data.data,this.addConf.loadStatus=!1,this.addConf.emptyText=""):204===t.Code?(this.$message({message:t.Message,type:"error"}),this.$router.push({path:this.$common.state.loginPath})):(this.addTableData=[],this.addConf.emptyText=t.Message,this.addConf.dataTotal=0,this.addConf.loadStatus=!1)}).catch(()=>{this.addTableData=[],this.addConf.emptyText="服务器连接失败...",this.addConf.dataTotal=0,this.addConf.loadStatus=!1})},addSizeChange(t){this.addConf.limit=t,this.getHouseTables()},addCurrentChange(t){this.addConf.curPage=t,this.getHouseTables()},addSelectionChange(t){this.addTableSelected=t},addBuildChange(t){this.unitVal=[],this.unitOptions=[],t&&this.getUnitData(),this.getHouseTables()},addSubmit(){this.isCommit=!0;let t={id:this.dialogTable.tableData[this.addIndex].id,rooms:this.addTableSelected.map(t=>t.id),vid:this.relatedVillage};this.$axios.post(this.urlObj.addrooms,t).then(t=>{if(200===t.Code)this.$message({type:"success",message:"添加房源成功！"}),this.getDialogTable(),this.showAddSource=!1;else{let a=t.Message?t.Message:"添加房源失败！";this.$message({type:"error",message:a})}this.isCommit=!1}).catch(()=>{this.$message({type:"error",message:"添加房源失败！"}),this.isCommit=!1})},processCount(){this.showProcess=!0,this.$axios.post(this.urlObj.arrearageProcess,{}).then(t=>{if(200===t.Code)this.$notify({title:"批量生成欠费状态",duration:8e3,offset:100,dangerouslyUseHTMLString:!0,message:`<strong><p>待生成物管费总数：${t.Data.wg_count}</p><p>待生成车位费总数：${t.Data.car_count}</p></strong>`});else{let a=t.Message?t.Message:"添加房源失败！";this.$message({type:"error",message:a})}}).catch(()=>{this.$message({type:"error",message:"查询失败"})})}}},u=h,g=(e("ab50"),e("1805")),p=Object(g["a"])(u,s,i,!1,null,null,null);a["default"]=p.exports},cd16:function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"项目名称","prop":"villagename","show":true,"color":"#999"},{"label":"批次名称","prop":"source_name","show":true},{"label":"关联楼栋","prop":"b_name","show":true,"color":"#999"},{"label":"操作时间","prop":"create_time","show":true,"color":"#999"},{"label":"描述","prop":"content","show":true},{"label":"操作人","prop":"realname","show":true,"color":"#69da61"}]}')},d590:function(t){t.exports=JSON.parse('{"commonet":{"label":"列名称","prop":"字段名称","width":"列宽度","type":"text/number/checkbox(0,1)/button","action":"抛出的方法名称","role":"type存在时使用操作加载对应的权限名","show":"显示/隐藏列","btns":{"name":"按钮名称","type":"按钮样式","size":"按钮大小","round":"是否圆角","class":"自定义class","action":"抛出的方法名称"}},"list":[{"label":"项目名称","prop":"villagename","show":true,"color":"#999"},{"label":"批次名称","prop":"name","show":true},{"label":"关联楼栋","prop":"block","show":true,"color":"#999"},{"label":"首次交房时间","prop":"interactive_time","show":true,"color":"#999"},{"label":"更新截止时间","prop":"arrears_end_time","show":true},{"label":"创建人","prop":"realname","show":true,"color":"#69da61"},{"label":"操作","prop":"","width":120,"type":"button","show":true,"btns":[{"name":"添加房源","type":"primary empty","size":"small","round":true,"action":"addSource","role":"addSource","token":"Btn-WFxogyvhC6Y8EN5pH2fJAsGZ"}]}]}')}}]);